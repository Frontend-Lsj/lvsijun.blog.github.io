<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SQL之母 | Bablvsj's Blog</title><meta name=keywords content="编程语言"><meta name=description content="教程： 基础语法 数据列输出顺序 SELECT {列名...} 全表查询 select * from 表名 查询 - 别名 别名语法 {原始字段名} as {别名} 来为查询结果的列名取一个便于理解的名"><meta name=author content><link rel=canonical href=https://bablvsj.github.io/posts/exams/sql%E4%B9%8B%E6%AF%8D/><link crossorigin=anonymous href=/assets/css/stylesheet.3543903b9a67b4b535bc2f28878a0972bc74bbb64bfa5358b406567081797e7b.css integrity="sha256-NUOQO5pntLU1vC8oh4oJcrx0u7ZL+lNYtAZWcIF5fns=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="SQL之母"><meta property="og:description" content="教程： 基础语法 数据列输出顺序 SELECT {列名...} 全表查询 select * from 表名 查询 - 别名 别名语法 {原始字段名} as {别名} 来为查询结果的列名取一个便于理解的名"><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/exams/sql%E4%B9%8B%E6%AF%8D/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-31T13:46:19+08:00"><meta property="article:modified_time" content="2023-08-31T13:46:19+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SQL之母"><meta name=twitter:description content="教程： 基础语法 数据列输出顺序 SELECT {列名...} 全表查询 select * from 表名 查询 - 别名 别名语法 {原始字段名} as {别名} 来为查询结果的列名取一个便于理解的名"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"文章","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"SQL之母","item":"https://bablvsj.github.io/posts/exams/sql%E4%B9%8B%E6%AF%8D/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SQL之母","name":"SQL之母","description":"教程： 基础语法 数据列输出顺序 SELECT {列名...} 全表查询 select * from 表名 查询 - 别名 别名语法 {原始字段名} as {别名} 来为查询结果的列名取一个便于理解的名","keywords":["编程语言"],"articleBody":"教程：\n基础语法 数据列输出顺序 SELECT {列名...} 全表查询 select * from 表名\n查询 - 别名 别名语法 {原始字段名} as {别名} 来为查询结果的列名取一个便于理解的名称。\n请编写一条 SQL 查询语句，从名为 student 的数据表中选择出所有学生的姓名（name）和年龄（age）信息，并为它们取别名为 学生姓名 和 学生年龄\n1 2 3 4 5 select name as '学生姓名', age as '学生年龄' from student; 查询 - 常量和运算 请编写一条 SQL 查询语句，从名为student的数据表中选择出所有学生的姓名（name）和分数（score），并且额外计算出分数的 2 倍（double_score）。\n1 2 3 4 5 6 select name, score, score * 2 as double_score from student; 条件查询 - where 1 2 3 SELECT 列1, 列2, ... FROM 表名 WHERE 条件; 请编写一条 SQL 查询语句，从名为student 的数据表中选择出所有学生的姓名（name）和成绩（score），要求学生姓名为 ’lvsj’。\n1 2 3 4 5 6 7 select name, score from student where name = 'lvsj'; 条件查询 - 运算符 =、 !=、\u003c、\u003e “BETWEEN” 运算符来筛选出在某个范围内的值。\n请编写一条 SQL 查询语句，从名为 student 的数据表中选择出所有学生的姓名（name）和年龄（age），要求学生姓名不等于 ‘热dog’ 。\n1 2 3 4 5 6 7 select name, age from student where name != '热dog'; 条件查询 空值 is null / is not null 请编写一条 SQL 查询语句，从名为 student 的数据表中选择出所有学生的姓名（name）、年龄（age）和成绩（score），要求学生年龄不为空值。\n1 2 3 4 5 6 7 8 select name, age, score from student where age is not null; 模糊查询 like / not like **通配符：\n百分号（%）：表示任意长度的任意字符序列。 下划线（_）：表示任意单个字符。 还可以使用模糊查询匹配开头和结尾：\n1 2 3 4 5 -- 只查询以 \"张\" 开头的数据行 select name, age, position from employees where name like '张%'; -- 只查询以 \"张\" 结尾的数据行 select name, age, position from employees where name like '%张'; 同理，可以使用 not like 来查询不包含某关键字的信息。\n请编写一条 SQL 查询语句，从名为 student 的数据表中选择出所有学生的姓名（name）和成绩（score），要求姓名（name）不包含 “李” 这个字。\n1 2 3 4 5 6 7 select name, score from student where name not like '%李%'; 逻辑运算 AND / OR / NOT AND：表示逻辑与，要求同时满足多个条件，才返回 true。 OR：表示逻辑或，要求满足其中任意一个条件，就返回 true。 NOT：表示逻辑非，用于否定一个条件（本来是 true，用了 not 后转为 false） 请编写一条 SQL 查询语句，从名为 student 的数据表中选择出所有学生的姓名（name）、成绩（score），要求学生的姓名包含 “李”，或者成绩（score）大于 500。\n1 2 3 4 5 6 7 8 select name, score from student where name like '%李%' or score \u003e 500; 去重 distinct 除了按照单字段去重外，DISTINCT 关键字还支持根据多个字段的组合来进行去重操作，确保多个字段的组合是唯一的。\n示例语法如下：\n1 distinct 字段1, 字段2, 字段3, ... 请编写一条 SQL 查询语句，从名为 student 的数据表中选择出所有不重复的班级 ID（class_id）和考试编号（exam_num）的组合。\n1 2 3 4 5 select distinct class_id, exam_num from student; 排序 order by 在排序的基础上，我们还可以根据多个字段的值进行排序。当第一个字段的值相同时，再按照第二个字段的值进行排序，以此类推。\n示例语法如下：\n1 order by 字段1 [升序/降序], 字段2 [升序/降序], ... 请编写一条 SQL 查询语句，从名为 student 的数据表中选择出学生姓名（name）、年龄（age）和成绩（score），首先按照成绩从大到小排序，如果成绩相同，则按照年龄从小到大排序。\n1 2 3 4 5 6 7 8 9 select name, age, score from student order by score desc, age asc; 截断和偏移 LIMIT关键字 请编写一条 SQL 查询语句，从名为 student 的数据表中选择学生姓名（name）和年龄（age），按照年龄从小到大排序，从第 2 条数据开始、截取 3 个学生的信息。\n1 2 3 4 5 6 7 8 9 select name, age from student order by age asc limit 1, 3; 条件分支 case when 实例语法：\n1 2 3 4 CASE WHEN (条件1) THEN 结果1 WHEN (条件2) THEN 结果2 ... ELSE 其他结果 END 题目： 假设有一个学生表 student，包含以下字段：name（姓名）、age（年龄）。请你编写一个 SQL 查询，将学生按照年龄划分为三个年龄等级（age_level）：60 岁以上为 “老同学”，20 岁以上（不包括 60 岁以上）为 “年轻”，20 岁及以下、以及没有年龄信息为 “小同学”。\n返回结果应包含学生的姓名（name）和年龄等级（age_level），并按姓名升序排序。\n1 2 3 4 5 6 7 8 9 10 11 select name, case when (age \u003e 60) then '老同学' when (age \u003e 20) then '年轻' else '小同学' end as age_level from student order by name asc; 函数 - 时间函数 常用的时间函数有：\nDATE：获取当前日期 DATETIME：获取当前日期时间 TIME：获取当前时间 假设有一个学生表 student，包含以下字段：name（姓名）、age（年龄）。 请你编写一个 SQL 查询，展示所有学生的姓名（name）和当前日期（列名为 “当前日期”）。\n1 2 3 4 5 select name, date() as '当前日期' from student; 函数 - 字符串处理 1 2 3 4 5 6 7 8 '`UPPER` 将字段转换为大写' select name, upper(name) as upper_name from employees; '`LOWER` 将字段转换为小写' select name, lower(name) as lower_name from employees; '`LENGTH` 计算字段长度' select name, length(name) as name_length from employees; 假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）。请你编写一个 SQL 查询，筛选出姓名为 ‘热dog’ 的学生，展示其学号（id）、姓名（name）及其大写姓名（upper_name）。\n1 2 3 4 5 6 7 8 select id, name, upper(name) as upper_name from student where name = '热dog' 函数 - 聚合函数 聚合函数是一类用于对数据集进行 汇总计算 的特殊函数。\n常见的聚合函数包括：\nCOUNT：计算指定列的行数或非空值的数量。 SUM：计算指定列的数值之和。 AVG：计算指定列的数值平均值。 MAX：找出指定列的最大值。 MIN：找出指定列的最小值。 示例 假设有一个订单表 orders，包含以下字段：order_id（订单号）、customer_id（客户编号）、amount（订单金额）。数据如下：\norder_id customer_id amount 1 A001 100 2 A002 200 3 A001 150 4 A003 50 1）使用聚合函数 COUNT 计算订单表中的总订单数：\n1 select count(*) as order_num from orders; // order_num = 4 2）使用聚合函数 COUNT(DISTINCT 列名) 计算订单表中不同客户的数量：\n1 select count(distinct customer_id) as customer_num FROM orders; // customer_num = 3 3）使用聚合函数 SUM 计算总订单金额：\n1 select sum(amount) as total_amount from orders; // total_amount = 500 假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、class_id（班级编号）、score（成绩）。请你编写一个 SQL 查询，汇总学生表中所有学生的总成绩（total_score）、平均成绩（avg_score）、最高成绩（max_score）和最低成绩（min_score）。\n1 2 3 4 5 6 7 select sum(score) as total_score, avg(score) as avg_score, max(score) as max_score, min(score) as min_score from student; 分组聚合 - 单字段分组 分组聚合是一种对数据进行分类并对每个分类进行聚合计算的操作。它允许我们按照指定的列或字段对数据进行分组，然后对每个分组应用聚合函数，如 COUNT、SUM、AVG 等，以获得分组后的汇总结果。\n举个例子：某个学校可以按照班级将学生分组，并对每个班级进行统计。查看每个班级有多少学生、每个班级的平均成绩。这样我们就能够对学校各班的学生情况有一个整体的了解，而不是单纯看个别学生的信息。\n在 SQL 中，通常使用 GROUP BY 关键字对数据进行分组。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、class_id（班级编号）、score（成绩）。请你编写一个 SQL 查询，统计学生表中每个班级的平均成绩（avg_score）。\n1 2 3 4 5 6 7 select class_id, avg(score) as avg_score from student group by class_id; 分组聚合 - 多字段分组 有时，单字段分组并不能满足我们的需求，比如想统计学校里每个班级每次考试的学生情况，这时就可以使用多字段分组。\n多字段分组和单字段分组的实现方式几乎一致，使用 GROUP BY 语法即可。\n假设有一个学生表 student，包含以下字段id（学号）、name（姓名）、class_id（班级编号）、exam_num（考试次数）、score（成绩）。请编写一个 SQL 查询，统计学生表中每个班级每次考试的总学生人数（total_num）。\n1 2 3 4 5 6 7 8 9 select class_id, exam_num, count(*) as total_num from student group by class_id, exam_num 分组聚合 - having 子句 HAVING 子句用于在分组聚合后对分组进行过滤。它允许我们对分组后的结果进行条件筛选，只保留满足特定条件的分组。\nHAVING 子句与条件查询 WHERE 子句的区别在于，WHERE 子句用于在 分组之前 进行过滤，而 HAVING 子句用于在 分组之后 进行过滤。\n假设有一个学生表 student，包含以下字段：id（学号)、name（姓名）、class_id（班级编号)、score（成绩）。请编写一个 SQL 查询，统计学生表中班级的总成绩超过 150 分的班级编号（class_id）和总成绩（total_score），并将总成绩按从高到低排序。\n1 2 3 4 5 6 7 8 9 10 11 select class_id, sum(score) as total_score from student group by class_id having total_score \u003e 150 order by total_score desc 查询进阶 - 关联查询 cross join 关联查询是一种用于联合多个数据表中的数据的查询方式\nCROSS JOIN 是一种简单的关联查询，不需要任何条件来匹配行，它直接将左表的 每一行 与右表的 每一行 进行组合，返回的结果是两个表的笛卡尔积。\n示例 假设有一个员工表 employees，包含以下字段：emp_id（员工编号）、emp_name（员工姓名）、department（所属部门）、salary（工资）。数据如下：\nemp_id emp_name department salary 1 小明 技术部 5000 2 鸡哥 财务部 6000 3 李华 销售部 4500 假设还有一个部门表 departments，包含以下字段：department（部门名称）、manager（部门经理）、location（所在地）。数据如下：\ndepartment manager location 技术部 张三 上海 财务部 李四 北京 销售部 王五 广州 使用 CROSS JOIN 进行关联查询，将员工表和部门表的所有行组合在一起，获取员工姓名、工资、部门名称和部门经理，示例 SQL 代码如下：\n1 2 3 SELECT e.emp_name, e.salary, e.department, d.manager FROM employees e CROSS JOIN departments d; 注意，在多表关联查询的 SQL 中，我们最好在选择字段时指定字段所属表的名称（比如 e.emp_name），还可以通过给表起别名（比如 employees e）来简化 SQL 语句。\n查询结果：\nemp_name salary department manager 小明 5000 技术部 张三 小明 5000 财务部 李四 小明 5000 销售部 王五 鸡哥 6000 技术部 张三 鸡哥 6000 财务部 李四 鸡哥 6000 销售部 王五 李华 4500 技术部 张三 李华 4500 财务部 李四 李华 4500 销售部 王五 假设有一个学生表 student ，包含以下字段：id（学号）、name（姓名）、age（年龄）、class_id（班级编号）；还有一个班级表 class ，包含以下字段：id（班级编号）、name（班级名称）。\n请你编写一个 SQL 查询，将学生表和班级表的所有行组合在一起，并返回学生姓名（student_name）、学生年龄（student_age）、班级编号（class_id）以及班级名称（class_name）。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 '错误示范' -- select -- s.name as student_name, -- s.age as student_age, -- s.calss_id, -- c.name as class_name -- from student s -- cross join class c; select s.name student_name, s.age student_age, s.class_id class_id, c.name class_name from student s join class c; inner join INNER JOIN 是一种常见的关联查询方式，它根据两个表之间的关联条件，将满足条件的行组合在一起。\nINNER JOIN 只返回两个表中满足关联条件的交集部分，即在两个表中都存在的匹配行。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、class_id（班级编号）。还有一个班级表 class，包含以下字段：id（班级编号）、name（班级名称）、level（班级级别）。\n请你编写一个 SQL 查询，根据学生表和班级表之间的班级编号进行匹配，返回学生姓名（student_name）、学生年龄（student_age）、班级编号（class_id）、班级名称（class_name）、班级级别（class_level）。\n1 2 3 4 5 6 7 select s.name student_name, s.age student_age, s.class_id class_id, c.name class_name, c.level class_level from student s join class c on s.class_id = c.id; outer join out join 是一种关联查询方式，它根据关联条件，将两个表中满足条件的行组合在一起，并包含没有匹配的行 。\n在 out join 中，包括 left out join 和 right out join 两种类型，它们分别表示查询左表和右表的所有行（即使没有被匹配），再加上满足条件的交集部分。\n有些数据库并不支持 right join 语法，那么如何实现 right join 呢？ 其实只需要把主表（from 后面的表）和关联表（ left join 后面的表）顺序进行调换即可！\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、class_id（班级编号）。还有一个班级表 class，包含以下字段：id（班级编号）、name（班级名称）、level（班级级别）。\n请你编写一个 SQL 查询，根据学生表和班级表之间的班级编号进行匹配，返回学生姓名（student_name）、学生年龄（student_age）、班级编号（class_id）、班级名称（class_name）、班级级别（class_level），要求必须返回所有学生的信息（即使对应的班级编号不存在）。\n1 2 3 4 5 6 7 8 9 select s.name student_name, s.age student_age, s.class_id class_id, c.name class_name, c.level class_level from student s left join class c on s.class_id = c.id; 子查询 子查询是指在一个查询语句内部 嵌套 另一个完整的查询语句，内层查询被称为子查询。 子查询可以用于获取更复杂的查询结果或者用于过滤数据。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。还有一个班级表 class，包含以下字段：id（班级编号）、name（班级名称）。\n请你编写一个 SQL 查询，使用子查询的方式来获取存在对应班级的学生的所有数据，返回学生姓名（name）、分数（score）、班级编号（class_id）字段。\n1 2 3 4 5 6 7 8 9 10 11 12 13 select name, score, class_id from student where class_id in ( select distinct id from class ) 子查询 - exists 子查询中的一种特殊类型是 “exists” 子查询，用于检查主查询的结果集是否存在满足条件的记录，它返回布尔值（True 或 False），而不返回实际的数据。\n和 exists 相对的是 not exists，用于查找不满足存在条件的记录。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。还有一个班级表 class，包含以下字段：id（班级编号）、name（班级名称）。\n请你编写一个 SQL 查询，使用 exists 子查询的方式来获取 不存在对应班级的 学生的所有数据，返回学生姓名（name）、年龄（age）、班级编号（class_id）字段。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 select name, age, class_id from student where not exists ( select 1 from class where student.class_id = class.id ) 组合查询 组合查询是一种将多个 SELECT 查询结果合并在一起的查询操作。\n包括两种常见的组合查询操作：UNION 和 UNION ALL。\nUNION 操作：它用于将两个或多个查询的结果集合并， 并去除重复的行 。即如果两个查询的结果有相同的行，则只保留一行。 UNION ALL 操作：它也用于将两个或多个查询的结果集合并， 但不去除重复的行 。即如果两个查询的结果有相同的行，则全部保留。 假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。还有一个新学生表 student_new，包含的字段和学生表完全一致。\n请编写一条 SQL 语句，获取所有学生表和新学生表的学生姓名（name）、年龄（age）、分数（score）、班级编号（class_id）字段，要求保留重复的学生记录。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 select name, age, score, class_id from student union all select name, age, score, class_id from student_new 开窗函数 - sum over 开窗函数是一种强大的查询工具，它允许我们在查询中对分组数据进行计算、 同时保留原始行的详细信息 。\n开窗函数可以与聚合函数（如 SUM、AVG、COUNT 等）结合使用，但与普通聚合函数不同，开窗函数不会导致结果集的行数减少。\n打个比方，可以将开窗函数想象成一种 “透视镜”，它能够将我们聚焦在某个特定的分组，同时还能看到整体的全景。\n本节我们先讲第一个开窗函数：sum over。\n该函数用法为：\n1 sum(计算字段名) over (partition by 分组字段名) 假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。 请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并计算每个班级的学生平均分（class_avg_score）。\n1 2 3 4 5 6 7 8 9 10 11 12 select id, name, age, score, class_id, avg(score) over ( partition by class_id ) as class_avg_score from student 开窗函数 - sum over order by 学习 sum over 函数的另一种用法：sum over order by，可以实现同组内数据的 累加求和 。\n示例用法如下：\n1 sum(计算字段名) over (partition by 分组字段名 order by 排序字段 排序规则) 举一个应用场景：老师在每个班级里依次点名，每点到一个学生，老师都会记录当前已点到的学生们的分数总和。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。 请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数升序的方式累加计算每个班级的学生总分（class_sum_score）。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 select id, name, age, score, class_id, sum(score) over ( partition by class_id order by score asc ) as class_sum_score from student 开窗函数 - rank Rank 开窗函数是 SQL 中一种用于对查询结果集中的行进行 排名 的开窗函数。它可以根据指定的列或表达式对结果集中的行进行排序，并为每一行分配一个排名。在排名过程中，相同的值将被赋予相同的排名，而不同的值将被赋予不同的排名。\n当存在并列（相同排序值）时，Rank 会跳过后续排名，并保留相同的排名。\n**Rank 开窗函数的常见用法是在查询结果中查找前几名（Top N）或排名最高的行。\nRank 开窗函数的语法如下：\n1 2 3 4 rank() over ( partition by 列名1, 列名2, ... -- 可选，用于指定分组列 order by 列名3 [asc|desc], 列名4 [asc|desc], ... -- 用于指定排序列及排序方式 ) as rank_column 其中，partition by 子句可选，用于指定分组列，将结果集按照指定列进行分组；order by 子句用于指定排序列及排序方式，决定了计算 rank 时的排序规则。as rank_column 用于指定生成的 Rank 排名列的别名。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。 请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式计算每个班级内的学生的分数排名（ranking）。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 select id, name, age, score, class_id, rank() over ( partition by class_id order by score desc ) as ranking from student 开窗函数 - row_number Row_Number 开窗函数是 SQL 中的一种用于为查询结果集中的每一行 分配唯一连续排名 的开窗函数。\n它与之前讲到的 Rank 函数不同，Row_Number 函数为每一行都分配一个唯一的整数值，不管是否存在并列（相同排序值）的情况。每一行都有一个唯一的行号，从 1 开始连续递增。\nrow_number 开窗函数的语法如下（几乎和 rank 函数一模一样）：\n1 2 3 4 row_number() over ( partition by column1, column2, ... -- 可选，用于指定分组列 order by column3 [asc|desc], column4 [asc|desc], ... -- 用于指定排序列及排序方式 ) as row_number_column 其中，PARTITION BY子句可选，用于指定分组列，将结果集按照指定列进行分组。ORDER BY 子句用于指定排序列及排序方式，决定了计算 Row_Number 时的排序规则。AS row_number_column 用于指定生成的行号列的别名。\n假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。 请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式给每个班级内的学生分配一个编号（row_number）。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 select id, name, age, score, class_id, ROW_NUMBER() over ( partition by class_id order by score desc ) as row_number from student 开窗函数 - lag / lead 开窗函数 Lag 和 Lead 的作用是获取在当前行之前或之后的行的值，这两个函数通常在需要比较相邻行数据或进行时间序列分析时非常有用。\n1）Lag 函数\nLag 函数用于获取 当前行之前 的某一列的值。它可以帮助我们查看上一行的数据。\nLag 函数的语法如下：\n1 2 3 4 lag(column_name, offset, default_value) over ( partition by partition_column order by sort_column ) 参数解释：\ncolumn_name：要获取值的列名。 offset：表示要向上偏移的行数。例如，offset为1表示获取上一行的值，offset为2表示获取上两行的值… default_value：可选参数，用于指定当没有前一行时的默认值。 PARTITION BY和ORDER BY子句可选，用于分组和排序数据。 2）Lead 函数\nLead 函数用于获取 当前行之后 的某一列的值。它可以帮助我们查看下一行的数据。\nLead 函数的语法如下：\n1 2 3 lead(column_name, offset, default_value) over ( partition by partition_column order by sort_column) 参数解释：\ncolumn_name：要获取值的列名。 offset：表示要向下偏移的行数。例如，offset为1表示获取下一行的值，offset为2表示获取下两行的值… default_value：可选参数，用于指定当没有后一行时的默认值。 PARTITION BY和ORDER BY子句可选，用于分组和排序数据。 假设有一个学生表 student，包含以下字段：id（学号）、name（姓名）、age（年龄）、score（分数）、class_id（班级编号）。 请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式获取每个班级内的学生的前一名学生姓名（prev_name）、后一名学生姓名（next_name）。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 select id, name, age, score, class_id, lag(name, 1, null) over ( partition by class_id order by score desc ) as prev_name, lead(name, 1, null) over ( partition by class_id order by score desc ) as next_name from student 测验 冒险者和金币 假设有一家冒险者公会，他们有一张名为 rewards 的表格，用于记录每个冒险者在各个任务中获得的金币奖励情况。\n表格字段如下：\nadventurer_id：冒险者ID，唯一标识每个冒险者。 adventurer_name：冒险者姓名。 task_id：任务ID，唯一标识每个任务。 task_name：任务名称。 reward_coins：冒险者在该任务中获得的金币奖励数量。 请你编写一条 SQL 查询语句，依次输出每个冒险者的 id（adventurer_id）、冒险者姓名（adventurer_name）、获得的总金币奖励（total_reward_coins），并按照总金币奖励从高到低排序，其中只列出总金币奖励排名前 3 的冒险者。\n1 2 3 4 5 6 7 8 9 select adventurer_id, adventurer_name, sum(reward_coins) as total_reward_coins from rewards group by adventurer_id,adventurer_name order by total_reward_coins desc limit 3; 魔法学院 假设有一家魔法学院，里面有许多学员在不同科目上进行学习和考试。请你设计一张名为magic_scores的表格，用于记录每位学员在不同科目中的考试成绩情况。表格字段如下：\nstudent_id：学员ID，唯一标识每位学员。 student_name：学员姓名。 subject_id：科目ID，唯一标识每个科目。 subject_name：科目名称。 score：学员在该科目的考试成绩。 请你编写一条 SQL 查询语句，依次输出每位学员的学院 ID（student_id）、学员姓名（student_name）、科目 ID（subject_id）、科目名称（subject_name）、学员在该科目的考试成绩（score）、该学员在每个科目中的成绩排名（score_rank），并将结果按照成绩从高到低进行排序。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 select student_id, student_name, subject_id, subject_name, score, rank() over ( partition by subject_id order by score desc ) as score_rank from magic_scores 大浪淘鸡 在神秘的海岛上，有一只传说中的大浪淘鸡，它身躯高大威武，羽毛闪烁着神秘的光芒。岛上的居民都传说大浪淘鸡是海洋之神的化身，它能够操纵海浪，带来平静或狂暴的海洋。为了验证这个传说是否属实，岛上的居民决定对大浪淘鸡进行观测和记录。\n有一张 chicken_observation 的表格，用于记录居民观测大浪淘鸡的信息。表格字段如下：\nobservation_id：观测记录ID，唯一标识每条观测记录 observer_name：观测者姓名 observation_date：观测日期 observation_location：观测地点 wave_intensity：观测到的海浪强度，用整数表示，数值越大，海浪越狂暴 请你编写一条 SQL 查询语句，找出观测地点包含 “大浪淘鸡” 且海浪强度超过 5 的观测记录，并依次输出每位观测者的姓名（observer_name）、观测日期（observation_date）以及观测到的海浪强度（wave_intensity）。\n1 2 3 4 5 6 7 8 9 10 11 12 select observer_name, observation_date, wave_intensity, observation_location from chicken_observation where (observation_location like '%大浪淘鸡%') and (wave_intensity \u003e 5) order by wave_intensity desc ","wordCount":"9892","inLanguage":"en","datePublished":"2023-08-31T13:46:19+08:00","dateModified":"2023-08-31T13:46:19+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/exams/sql%E4%B9%8B%E6%AF%8D/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=主页><span>主页</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=时间轴><span>时间轴</span></a></li><li><a href=https://bablvsj.github.io/tags title=标签><span>标签</span></a></li><li><a href=https://bablvsj.github.io/about title=关于><span>关于</span></a></li><li><a href=https://bablvsj.github.io/search title="🔍 (Alt + /)" accesskey=/><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>SQL之母</h1><div class=post-meta><ul class=post-tags-meta><a href=https://bablvsj.github.io/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/>编程语言</a></ul>20 min&nbsp;·&nbsp;<span title='2023-08-31 13:46:19 +0800 +0800'>2023/08/31</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#%e5%9f%ba%e7%a1%80%e8%af%ad%e6%b3%95 aria-label=基础语法>基础语法</a><ul><li><a href=#%e6%9f%a5%e8%af%a2---%e5%88%ab%e5%90%8d aria-label="查询 - 别名">查询 - 别名</a></li><li><a href=#%e6%9f%a5%e8%af%a2---%e5%b8%b8%e9%87%8f%e5%92%8c%e8%bf%90%e7%ae%97 aria-label="查询 - 常量和运算">查询 - 常量和运算</a></li><li><a href=#%e6%9d%a1%e4%bb%b6%e6%9f%a5%e8%af%a2---where aria-label="条件查询 - where">条件查询 - where</a></li><li><a href=#%e6%9d%a1%e4%bb%b6%e6%9f%a5%e8%af%a2---%e8%bf%90%e7%ae%97%e7%ac%a6 aria-label="条件查询 - 运算符">条件查询 - 运算符</a></li><li><a href=#%e6%9d%a1%e4%bb%b6%e6%9f%a5%e8%af%a2-%e7%a9%ba%e5%80%bc-is-null--is-not-null aria-label="条件查询 空值 is null / is not null">条件查询 空值 is null / is not null</a></li><li><a href=#%e6%a8%a1%e7%b3%8a%e6%9f%a5%e8%af%a2--like--not-like aria-label="模糊查询  like / not like">模糊查询 like / not like</a></li><li><a href=#%e9%80%bb%e8%be%91%e8%bf%90%e7%ae%97-and--or--not aria-label="逻辑运算 AND / OR / NOT">逻辑运算 AND / OR / NOT</a></li><li><a href=#%e5%8e%bb%e9%87%8d-distinct aria-label="去重 distinct">去重 distinct</a></li><li><a href=#%e6%8e%92%e5%ba%8f-order-by aria-label="排序 order by">排序 order by</a></li><li><a href=#%e6%88%aa%e6%96%ad%e5%92%8c%e5%81%8f%e7%a7%bb-limit%e5%85%b3%e9%94%ae%e5%ad%97 aria-label="截断和偏移 LIMIT关键字">截断和偏移 LIMIT关键字</a></li><li><a href=#%e6%9d%a1%e4%bb%b6%e5%88%86%e6%94%afcase-when aria-label="条件分支 case when">条件分支 <code>case when</code></a></li><li><a href=#%e5%87%bd%e6%95%b0---%e6%97%b6%e9%97%b4%e5%87%bd%e6%95%b0 aria-label="函数 - 时间函数">函数 - 时间函数</a></li><li><a href=#%e5%87%bd%e6%95%b0---%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%a4%84%e7%90%86 aria-label="函数 - 字符串处理">函数 - 字符串处理</a></li><li><a href=#%e5%87%bd%e6%95%b0---%e8%81%9a%e5%90%88%e5%87%bd%e6%95%b0 aria-label="函数 - 聚合函数">函数 - 聚合函数</a><ul><li><a href=#%e7%a4%ba%e4%be%8b aria-label=示例>示例</a></li></ul></li><li><a href=#%e5%88%86%e7%bb%84%e8%81%9a%e5%90%88---%e5%8d%95%e5%ad%97%e6%ae%b5%e5%88%86%e7%bb%84 aria-label="分组聚合 - 单字段分组">分组聚合 - 单字段分组</a></li><li><a href=#%e5%88%86%e7%bb%84%e8%81%9a%e5%90%88---%e5%a4%9a%e5%ad%97%e6%ae%b5%e5%88%86%e7%bb%84 aria-label="分组聚合 - 多字段分组">分组聚合 - 多字段分组</a></li><li><a href=#%e5%88%86%e7%bb%84%e8%81%9a%e5%90%88---having-%e5%ad%90%e5%8f%a5 aria-label="分组聚合 - having 子句">分组聚合 - having 子句</a></li></ul></li><li><a href=#%e6%9f%a5%e8%af%a2%e8%bf%9b%e9%98%b6---%e5%85%b3%e8%81%94%e6%9f%a5%e8%af%a2 aria-label="查询进阶 - 关联查询">查询进阶 - 关联查询</a><ul><li><a href=#cross-join aria-label="cross join">cross join</a><ul><li><a href=#%e7%a4%ba%e4%be%8b-1 aria-label=示例>示例</a></li></ul></li><li><a href=#inner-join aria-label=" inner join"> inner join</a></li><li><a href=#outer-join aria-label="outer join">outer join</a></li><li><a href=#%e5%ad%90%e6%9f%a5%e8%af%a2 aria-label=子查询>子查询</a></li><li><a href=#%e5%ad%90%e6%9f%a5%e8%af%a2---exists aria-label="子查询 - exists">子查询 - exists</a></li><li><a href=#%e7%bb%84%e5%90%88%e6%9f%a5%e8%af%a2 aria-label=组合查询>组合查询</a></li><li><a href=#%e5%bc%80%e7%aa%97%e5%87%bd%e6%95%b0---sum-over aria-label="开窗函数 - sum over">开窗函数 - sum over</a></li><li><a href=#%e5%bc%80%e7%aa%97%e5%87%bd%e6%95%b0---sum-over-order-by aria-label="开窗函数 - sum over order by">开窗函数 - sum over order by</a></li><li><a href=#%e5%bc%80%e7%aa%97%e5%87%bd%e6%95%b0---rank aria-label="开窗函数 - rank">开窗函数 - rank</a></li><li><a href=#%e5%bc%80%e7%aa%97%e5%87%bd%e6%95%b0---row_number aria-label="开窗函数 - row_number">开窗函数 - row_number</a></li><li><a href=#%e5%bc%80%e7%aa%97%e5%87%bd%e6%95%b0---lag--lead aria-label="开窗函数 - lag / lead">开窗函数 - lag / lead</a></li></ul></li><li><a href=#%e6%b5%8b%e9%aa%8c aria-label=测验>测验</a><ul><li><a href=#%e5%86%92%e9%99%a9%e8%80%85%e5%92%8c%e9%87%91%e5%b8%81 aria-label=冒险者和金币>冒险者和金币</a></li><li><a href=#%e9%ad%94%e6%b3%95%e5%ad%a6%e9%99%a2 aria-label=魔法学院>魔法学院</a></li><li><a href=#%e5%a4%a7%e6%b5%aa%e6%b7%98%e9%b8%a1 aria-label=大浪淘鸡>大浪淘鸡</a></li></ul></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p><a href=https://sqlmother.solargod.cn/>教程：</a></p><h3 id=基础语法>基础语法<a hidden class=anchor aria-hidden=true href=#基础语法>#</a></h3><p><strong>数据列输出顺序 <code>SELECT {列名...}</code></strong>
<strong>全表查询 <code>select * from 表名</code></strong></p><h4 id=查询---别名>查询 - 别名<a hidden class=anchor aria-hidden=true href=#查询---别名>#</a></h4><p>别名语法 <code>{原始字段名} as {别名}</code> 来为查询结果的列名取一个便于理解的名称。</p><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出所有学生的姓名（name）和年龄（age）信息，并为它们取别名为 <code>学生姓名</code> 和 <code>学生年龄</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s1>&#39;学生姓名&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>age</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s1>&#39;学生年龄&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=查询---常量和运算>查询 - 常量和运算<a hidden class=anchor aria-hidden=true href=#查询---常量和运算>#</a></h4><p>请编写一条 SQL 查询语句，从名为<code>student</code>的数据表中选择出所有学生的姓名（name）和分数（score），并且额外计算出分数的 2 倍（double_score）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>double_score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=条件查询---where>条件查询 - where<a hidden class=anchor aria-hidden=true href=#条件查询---where>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=err>列</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=err>列</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=err>表名</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=err>条件</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>请编写一条 SQL 查询语句，从名为<code>student</code> 的数据表中选择出所有学生的姓名（name）和成绩（score），要求学生姓名为 &rsquo;lvsj&rsquo;。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;lvsj&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=条件查询---运算符>条件查询 - 运算符<a hidden class=anchor aria-hidden=true href=#条件查询---运算符>#</a></h4><p><code>=</code>、 <code>!=</code>、<code>&lt;</code>、<code>></code>
&ldquo;BETWEEN&rdquo; 运算符来筛选出在某个范围内的值。</p><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出所有学生的姓名（name）和年龄（age），要求学生姓名不等于 &lsquo;热dog&rsquo; 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>age</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>student</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>name</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;热dog&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=条件查询-空值-is-null--is-not-null>条件查询 空值 is null / is not null<a hidden class=anchor aria-hidden=true href=#条件查询-空值-is-null--is-not-null>#</a></h4><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出所有学生的姓名（name）、年龄（age）和成绩（score），要求学生年龄不为空值。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>score</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>student</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>age</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=no>null</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=模糊查询--like--not-like>模糊查询 like / not like<a hidden class=anchor aria-hidden=true href=#模糊查询--like--not-like>#</a></h4><p>**通配符：</p><ul><li>百分号（%）：表示任意长度的任意字符序列。</li><li>下划线（_）：表示任意单个字符。</li></ul><p>还可以使用模糊查询匹配开头和结尾：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 只查询以 &#34;张&#34; 开头的数据行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;张%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 只查询以 &#34;张&#34; 结尾的数据行
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w> </span><span class=k>position</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%张&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>同理，可以使用 <code>not like</code> 来查询不包含某关键字的信息。</p><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出所有学生的姓名（name）和成绩（score），要求姓名（name）不包含 &ldquo;李&rdquo; 这个字。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%李%&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=逻辑运算-and--or--not>逻辑运算 AND / OR / NOT<a hidden class=anchor aria-hidden=true href=#逻辑运算-and--or--not>#</a></h4><ul><li>AND：表示逻辑与，要求同时满足多个条件，才返回 true。</li><li>OR：表示逻辑或，要求满足其中任意一个条件，就返回 true。</li><li>NOT：表示逻辑非，用于否定一个条件（本来是 true，用了 not 后转为 false）</li></ul><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出所有学生的姓名（name）、成绩（score），要求学生的姓名包含 &ldquo;李&rdquo;，或者成绩（score）大于 500。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%李%&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>or</span><span class=w> </span><span class=n>score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>500</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=去重-distinct>去重 distinct<a hidden class=anchor aria-hidden=true href=#去重-distinct>#</a></h4><p>除了按照单字段去重外，<code>DISTINCT</code> 关键字还支持根据多个字段的组合来进行去重操作，确保多个字段的组合是唯一的。</p><p>示例语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>distinct</span><span class=w> </span><span class=err>字段</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=err>字段</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=err>字段</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出所有不重复的班级 ID（class_id）和考试编号（exam_num）的组合。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>exam_num</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=排序-order-by>排序 order by<a hidden class=anchor aria-hidden=true href=#排序-order-by>#</a></h4><p>在排序的基础上，我们还可以根据多个字段的值进行排序。当第一个字段的值相同时，再按照第二个字段的值进行排序，以此类推。</p><p>示例语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>字段</span><span class=mi>1</span><span class=w> </span><span class=p>[</span><span class=err>升序</span><span class=o>/</span><span class=err>降序</span><span class=p>],</span><span class=w> </span><span class=err>字段</span><span class=mi>2</span><span class=w> </span><span class=p>[</span><span class=err>升序</span><span class=o>/</span><span class=err>降序</span><span class=p>],</span><span class=w> </span><span class=p>...</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择出学生姓名（name）、年龄（age）和成绩（score），首先按照成绩从大到小排序，如果成绩相同，则按照年龄从小到大排序。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=w> </span><span class=k>desc</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=w> </span><span class=k>asc</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=截断和偏移-limit关键字>截断和偏移 LIMIT关键字<a hidden class=anchor aria-hidden=true href=#截断和偏移-limit关键字>#</a></h4><p>请编写一条 SQL 查询语句，从名为 <code>student</code> 的数据表中选择学生姓名（name）和年龄（age），按照年龄从小到大排序，从第 2 条数据开始、截取 3 个学生的信息。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=w> </span><span class=k>asc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>limit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=条件分支case-when>条件分支 <code>case when</code><a hidden class=anchor aria-hidden=true href=#条件分支case-when>#</a></h4><p>实例语法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=p>(</span><span class=err>条件</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=err>结果</span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	   </span><span class=k>WHEN</span><span class=w> </span><span class=p>(</span><span class=err>条件</span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=err>结果</span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	   </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	   </span><span class=k>ELSE</span><span class=w> </span><span class=err>其他结果</span><span class=w> </span><span class=k>END</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>题目：
假设有一个学生表 <code>student</code>，包含以下字段：<code>name</code>（姓名）、<code>age</code>（年龄）。请你编写一个 SQL 查询，将学生按照年龄划分为三个年龄等级（age_level）：60 岁以上为 &ldquo;老同学&rdquo;，20 岁以上（不包括 60 岁以上）为 &ldquo;年轻&rdquo;，20 岁及以下、以及没有年龄信息为 &ldquo;小同学&rdquo;。</p><p>返回结果应包含学生的姓名（name）和年龄等级（age_level），并按姓名升序排序。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>case</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>when</span><span class=w> </span><span class=p>(</span><span class=n>age</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>60</span><span class=p>)</span><span class=w> </span><span class=k>then</span><span class=w> </span><span class=s1>&#39;老同学&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>when</span><span class=w> </span><span class=p>(</span><span class=n>age</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>then</span><span class=w> </span><span class=s1>&#39;年轻&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;小同学&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>end</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>age_level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=k>asc</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=函数---时间函数>函数 - 时间函数<a hidden class=anchor aria-hidden=true href=#函数---时间函数>#</a></h4><p>常用的时间函数有：</p><ul><li>DATE：获取当前日期</li><li>DATETIME：获取当前日期时间</li><li>TIME：获取当前时间</li></ul><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>name</code>（姓名）、<code>age</code>（年龄）。
请你编写一个 SQL 查询，展示所有学生的姓名（name）和当前日期（列名为 &ldquo;当前日期&rdquo;）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>date</span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s1>&#39;当前日期&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=函数---字符串处理>函数 - 字符串处理<a hidden class=anchor aria-hidden=true href=#函数---字符串处理>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39;`UPPER` 将字段转换为大写&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=k>upper</span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>upper_name</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s1>&#39;`LOWER` 将字段转换为小写&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=k>lower</span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>lower_name</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s1>&#39;`LENGTH` 计算字段长度&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=k>length</span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>name_length</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）。请你编写一个 SQL 查询，筛选出姓名为 &lsquo;热dog&rsquo; 的学生，展示其学号（id）、姓名（name）及其大写姓名（upper_name）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>upper</span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>upper_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;热dog&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=函数---聚合函数>函数 - 聚合函数<a hidden class=anchor aria-hidden=true href=#函数---聚合函数>#</a></h4><p>聚合函数是一类用于对数据集进行 <strong>汇总计算</strong> 的特殊函数。</p><p>常见的聚合函数包括：</p><ul><li>COUNT：计算指定列的行数或非空值的数量。</li><li>SUM：计算指定列的数值之和。</li><li>AVG：计算指定列的数值平均值。</li><li>MAX：找出指定列的最大值。</li><li>MIN：找出指定列的最小值。</li></ul><h5 id=示例>示例<a hidden class=anchor aria-hidden=true href=#示例>#</a></h5><p>假设有一个订单表 <code>orders</code>，包含以下字段：<code>order_id</code>（订单号）、<code>customer_id</code>（客户编号）、<code>amount</code>（订单金额）。数据如下：</p><table><thead><tr><th>order_id</th><th>customer_id</th><th>amount</th></tr></thead><tbody><tr><td>1</td><td>A001</td><td>100</td></tr><tr><td>2</td><td>A002</td><td>200</td></tr><tr><td>3</td><td>A001</td><td>150</td></tr><tr><td>4</td><td>A003</td><td>50</td></tr></tbody></table><p>1）使用聚合函数 <code>COUNT</code> 计算订单表中的总订单数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>order_num</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>    </span><span class=o>//</span><span class=w> </span><span class=n>order_num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>4</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>2）使用聚合函数 <code>COUNT(DISTINCT 列名)</code> 计算订单表中不同客户的数量：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=k>distinct</span><span class=w> </span><span class=n>customer_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>customer_num</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>   </span><span class=o>//</span><span class=w> </span><span class=n>customer_num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>3）使用聚合函数 <code>SUM</code> 计算总订单金额：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_amount</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>   </span><span class=o>//</span><span class=w> </span><span class=n>total_amount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>500</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>class_id</code>（班级编号）、<code>score</code>（成绩）。请你编写一个 SQL 查询，汇总学生表中所有学生的总成绩（total_score）、平均成绩（avg_score）、最高成绩（max_score）和最低成绩（min_score）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nf>sum</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_score</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nf>avg</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>avg_score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nf>max</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>max_score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nf>min</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>min_score</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>student</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=分组聚合---单字段分组>分组聚合 - 单字段分组<a hidden class=anchor aria-hidden=true href=#分组聚合---单字段分组>#</a></h4><p>分组聚合是一种对数据进行分类并对每个分类进行聚合计算的操作。它允许我们按照指定的列或字段对数据进行分组，然后对每个分组应用聚合函数，如 COUNT、SUM、AVG 等，以获得分组后的汇总结果。</p><p>举个例子：某个学校可以按照班级将学生分组，并对每个班级进行统计。查看每个班级有多少学生、每个班级的平均成绩。这样我们就能够对学校各班的学生情况有一个整体的了解，而不是单纯看个别学生的信息。</p><p>在 SQL 中，通常使用 <code>GROUP BY</code> 关键字对数据进行分组。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>class_id</code>（班级编号）、<code>score</code>（成绩）。请你编写一个 SQL 查询，统计学生表中每个班级的平均成绩（avg_score）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>avg</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>avg_score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=分组聚合---多字段分组>分组聚合 - 多字段分组<a hidden class=anchor aria-hidden=true href=#分组聚合---多字段分组>#</a></h4><p>有时，单字段分组并不能满足我们的需求，比如想统计学校里每个班级每次考试的学生情况，这时就可以使用多字段分组。</p><p>多字段分组和单字段分组的实现方式几乎一致，使用 <code>GROUP BY</code> 语法即可。</p><p>假设有一个学生表 <code>student</code>，包含以下字段<code>id</code>（学号）、<code>name</code>（姓名）、<code>class_id</code>（班级编号）、<code>exam_num</code>（考试次数）、<code>score</code>（成绩）。请编写一个 SQL 查询，统计学生表中每个班级每次考试的总学生人数（total_num）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>exam_num</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_num</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>exam_num</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=分组聚合---having-子句>分组聚合 - having 子句<a hidden class=anchor aria-hidden=true href=#分组聚合---having-子句>#</a></h4><p>HAVING 子句用于在分组聚合后对分组进行过滤。它允许我们对分组后的结果进行条件筛选，只保留满足特定条件的分组。</p><p>HAVING 子句与条件查询 WHERE 子句的区别在于，WHERE 子句用于在 <strong>分组之前</strong> 进行过滤，而 HAVING 子句用于在 <strong>分组之后</strong> 进行过滤。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号)、<code>name</code>（姓名）、<code>class_id</code>（班级编号)、<code>score</code>（成绩）。请编写一个 SQL 查询，统计学生表中班级的总成绩超过 150 分的班级编号（class_id）和总成绩（total_score），并将总成绩按从高到低排序。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>sum</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>having</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>total_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>150</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>total_score</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=查询进阶---关联查询>查询进阶 - 关联查询<a hidden class=anchor aria-hidden=true href=#查询进阶---关联查询>#</a></h3><h4 id=cross-join>cross join<a hidden class=anchor aria-hidden=true href=#cross-join>#</a></h4><p>关联查询是一种用于联合多个数据表中的数据的查询方式</p><p><code>CROSS JOIN</code> 是一种简单的关联查询，不需要任何条件来匹配行，它直接将左表的 <strong>每一行</strong> 与右表的 <strong>每一行</strong> 进行组合，返回的结果是两个表的笛卡尔积。</p><h5 id=示例-1>示例<a hidden class=anchor aria-hidden=true href=#示例-1>#</a></h5><p>假设有一个员工表 <code>employees</code>，包含以下字段：<code>emp_id</code>（员工编号）、<code>emp_name</code>（员工姓名）、<code>department</code>（所属部门）、<code>salary</code>（工资）。数据如下：</p><table><thead><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th></tr></thead><tbody><tr><td>1</td><td>小明</td><td>技术部</td><td>5000</td></tr><tr><td>2</td><td>鸡哥</td><td>财务部</td><td>6000</td></tr><tr><td>3</td><td>李华</td><td>销售部</td><td>4500</td></tr></tbody></table><p>假设还有一个部门表 <code>departments</code>，包含以下字段：<code>department</code>（部门名称）、<code>manager</code>（部门经理）、<code>location</code>（所在地）。数据如下：</p><table><thead><tr><th>department</th><th>manager</th><th>location</th></tr></thead><tbody><tr><td>技术部</td><td>张三</td><td>上海</td></tr><tr><td>财务部</td><td>李四</td><td>北京</td></tr><tr><td>销售部</td><td>王五</td><td>广州</td></tr></tbody></table><p>使用 CROSS JOIN 进行关联查询，将员工表和部门表的所有行组合在一起，获取员工姓名、工资、部门名称和部门经理，示例 SQL 代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>emp_name</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>salary</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>department</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>manager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>注意，在多表关联查询的 SQL 中，我们最好在选择字段时指定字段所属表的名称（比如 e.emp_name），还可以通过给表起别名（比如 employees e）来简化 SQL 语句。</p><p>查询结果：</p><table><thead><tr><th>emp_name</th><th>salary</th><th>department</th><th>manager</th></tr></thead><tbody><tr><td>小明</td><td>5000</td><td>技术部</td><td>张三</td></tr><tr><td>小明</td><td>5000</td><td>财务部</td><td>李四</td></tr><tr><td>小明</td><td>5000</td><td>销售部</td><td>王五</td></tr><tr><td>鸡哥</td><td>6000</td><td>技术部</td><td>张三</td></tr><tr><td>鸡哥</td><td>6000</td><td>财务部</td><td>李四</td></tr><tr><td>鸡哥</td><td>6000</td><td>销售部</td><td>王五</td></tr><tr><td>李华</td><td>4500</td><td>技术部</td><td>张三</td></tr><tr><td>李华</td><td>4500</td><td>财务部</td><td>李四</td></tr><tr><td>李华</td><td>4500</td><td>销售部</td><td>王五</td></tr></tbody></table><p>假设有一个学生表 <code>student</code> ，包含以下字段：id（学号）、name（姓名）、age（年龄）、class_id（班级编号）；还有一个班级表 <code>class</code> ，包含以下字段：id（班级编号）、name（班级名称）。</p><p>请你编写一个 SQL 查询，将学生表和班级表的所有行组合在一起，并返回学生姓名（student_name）、学生年龄（student_age）、班级编号（class_id）以及班级名称（class_name）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=s1>&#39;错误示范&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- select 
</span></span></span><span class=line><span class=cl><span class=c1>-- 	s.name as student_name,
</span></span></span><span class=line><span class=cl><span class=c1>-- 	s.age as student_age,
</span></span></span><span class=line><span class=cl><span class=c1>-- 	s.calss_id,
</span></span></span><span class=line><span class=cl><span class=c1>-- 	c.name as class_name 
</span></span></span><span class=line><span class=cl><span class=c1>-- from student s 
</span></span></span><span class=line><span class=cl><span class=c1>-- cross join class c;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=n>student_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=n>student_age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>class_id</span><span class=w> </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=n>class_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=n>c</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=inner-join> inner join<a hidden class=anchor aria-hidden=true href=#inner-join>#</a></h4><p>INNER JOIN 是一种常见的关联查询方式，它根据两个表之间的关联条件，将满足条件的行组合在一起。</p><p>INNER JOIN 只返回两个表中满足关联条件的交集部分，即在两个表中都存在的匹配行。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>class_id</code>（班级编号）。还有一个班级表 <code>class</code>，包含以下字段：<code>id</code>（班级编号）、<code>name</code>（班级名称）、<code>level</code>（班级级别）。</p><p>请你编写一个 SQL 查询，根据学生表和班级表之间的班级编号进行匹配，返回学生姓名（<code>student_name</code>）、学生年龄（<code>student_age</code>）、班级编号（<code>class_id</code>）、班级名称（<code>class_name</code>）、班级级别（<code>class_level</code>）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=n>student_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=n>student_age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>class_id</span><span class=w> </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=n>class_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>c</span><span class=p>.</span><span class=n>level</span><span class=w> </span><span class=n>class_level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>class_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=outer-join>outer join<a hidden class=anchor aria-hidden=true href=#outer-join>#</a></h4><p>out join 是一种关联查询方式，它根据关联条件，将两个表中满足条件的行组合在一起，并<strong>包含没有匹配的行</strong> 。</p><p>在 out join 中，包括 left out join 和 right out join 两种类型，它们分别表示查询左表和右表的所有行（即使没有被匹配），再加上满足条件的交集部分。</p><p>有些数据库并不支持 right join 语法，那么如何实现 right join 呢？
其实只需要把主表（from 后面的表）和关联表（ left join 后面的表）顺序进行调换即可！</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>class_id</code>（班级编号）。还有一个班级表 <code>class</code>，包含以下字段：<code>id</code>（班级编号）、<code>name</code>（班级名称）、<code>level</code>（班级级别）。</p><p>请你编写一个 SQL 查询，根据学生表和班级表之间的班级编号进行匹配，返回学生姓名（<code>student_name</code>）、学生年龄（<code>student_age</code>）、班级编号（<code>class_id</code>）、班级名称（<code>class_name</code>）、班级级别（<code>class_level</code>），要求必须返回所有学生的信息（即使对应的班级编号不存在）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=n>student_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>age</span><span class=w> </span><span class=n>student_age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>s</span><span class=p>.</span><span class=n>class_id</span><span class=w> </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=n>class_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>c</span><span class=p>.</span><span class=n>level</span><span class=w> </span><span class=n>class_level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>class</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>class_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=子查询>子查询<a hidden class=anchor aria-hidden=true href=#子查询>#</a></h4><p>子查询是指在一个查询语句内部 <strong>嵌套</strong> 另一个完整的查询语句，内层查询被称为子查询。
子查询可以用于获取更复杂的查询结果或者用于过滤数据。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。还有一个班级表 <code>class</code>，包含以下字段：<code>id</code>（班级编号）、<code>name</code>（班级名称）。</p><p>请你编写一个 SQL 查询，使用子查询的方式来获取存在对应班级的学生的所有数据，返回学生姓名（<code>name</code>）、分数（<code>score</code>）、班级编号（<code>class_id</code>）字段。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=子查询---exists>子查询 - exists<a hidden class=anchor aria-hidden=true href=#子查询---exists>#</a></h4><p>子查询中的一种特殊类型是 &ldquo;exists&rdquo; 子查询，用于检查主查询的结果集是否存在满足条件的记录，它返回布尔值（True 或 False），而不返回实际的数据。</p><p>和 exists 相对的是 not exists，用于查找不满足存在条件的记录。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。还有一个班级表 <code>class</code>，包含以下字段：<code>id</code>（班级编号）、<code>name</code>（班级名称）。</p><p>请你编写一个 SQL 查询，使用 exists 子查询的方式来获取 <strong>不存在对应班级的</strong> 学生的所有数据，返回学生姓名（<code>name</code>）、年龄（<code>age</code>）、班级编号（<code>class_id</code>）字段。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>not</span><span class=w> </span><span class=k>exists</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>student</span><span class=p>.</span><span class=n>class_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>class</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=组合查询>组合查询<a hidden class=anchor aria-hidden=true href=#组合查询>#</a></h4><p>组合查询是一种将多个 SELECT 查询结果合并在一起的查询操作。</p><p>包括两种常见的组合查询操作：UNION 和 UNION ALL。</p><ol><li>UNION 操作：它用于将两个或多个查询的结果集合并， <strong>并去除重复的行</strong> 。即如果两个查询的结果有相同的行，则只保留一行。</li><li>UNION ALL 操作：它也用于将两个或多个查询的结果集合并， <strong>但不去除重复的行</strong> 。即如果两个查询的结果有相同的行，则全部保留。</li></ol><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。还有一个新学生表 <code>student_new</code>，包含的字段和学生表完全一致。</p><p>请编写一条 SQL 语句，获取所有学生表和新学生表的学生姓名（<code>name</code>）、年龄（<code>age</code>）、分数（<code>score</code>）、班级编号（<code>class_id</code>）字段，要求保留重复的学生记录。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>union</span><span class=w> </span><span class=k>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student_new</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=开窗函数---sum-over>开窗函数 - sum over<a hidden class=anchor aria-hidden=true href=#开窗函数---sum-over>#</a></h4><p>开窗函数是一种强大的查询工具，它允许我们在查询中对分组数据进行计算、 <strong>同时保留原始行的详细信息</strong> 。</p><p>开窗函数可以与聚合函数（如 SUM、AVG、COUNT 等）结合使用，但与普通聚合函数不同，开窗函数不会导致结果集的行数减少。</p><p>打个比方，可以将开窗函数想象成一种 &ldquo;透视镜&rdquo;，它能够将我们聚焦在某个特定的分组，同时还能看到整体的全景。</p><p>本节我们先讲第一个开窗函数：sum over。</p><p>该函数用法为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>sum</span><span class=p>(</span><span class=err>计算字段名</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>分组字段名</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。
请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并计算每个班级的学生平均分（class_avg_score）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>avg</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>class_avg_score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=开窗函数---sum-over-order-by>开窗函数 - sum over order by<a hidden class=anchor aria-hidden=true href=#开窗函数---sum-over-order-by>#</a></h4><p>学习 sum over 函数的另一种用法：sum over order by，可以实现同组内数据的 <strong>累加求和</strong> 。</p><p>示例用法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>sum</span><span class=p>(</span><span class=err>计算字段名</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>分组字段名</span><span class=w> </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>排序字段</span><span class=w> </span><span class=err>排序规则</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>举一个应用场景：老师在每个班级里依次点名，每点到一个学生，老师都会记录当前已点到的学生们的分数总和。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。
请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数升序的方式累加计算每个班级的学生总分（class_sum_score）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>sum</span><span class=p>(</span><span class=n>score</span><span class=p>)</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>score</span><span class=w> </span><span class=k>asc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>class_sum_score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=开窗函数---rank>开窗函数 - rank<a hidden class=anchor aria-hidden=true href=#开窗函数---rank>#</a></h4><p>Rank 开窗函数是 SQL 中一种用于对查询结果集中的行进行 <strong>排名</strong> 的开窗函数。它可以根据指定的列或表达式对结果集中的行进行排序，并为每一行分配一个排名。在排名过程中，相同的值将被赋予相同的排名，而不同的值将被赋予不同的排名。</p><blockquote><p>当存在并列（相同排序值）时，Rank 会跳过后续排名，并保留相同的排名。</p></blockquote><p>**Rank 开窗函数的常见用法是在查询结果中查找前几名（Top N）或排名最高的行。</p><p>Rank 开窗函数的语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>rank</span><span class=p>()</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>列名</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=err>列名</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=c1>-- 可选，用于指定分组列
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>列名</span><span class=mi>3</span><span class=w> </span><span class=p>[</span><span class=k>asc</span><span class=o>|</span><span class=k>desc</span><span class=p>],</span><span class=w> </span><span class=err>列名</span><span class=mi>4</span><span class=w> </span><span class=p>[</span><span class=k>asc</span><span class=o>|</span><span class=k>desc</span><span class=p>],</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=c1>-- 用于指定排序列及排序方式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rank_column</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>其中，<code>partition by</code> 子句可选，用于指定分组列，将结果集按照指定列进行分组；<code>order by</code> 子句用于指定排序列及排序方式，决定了计算 rank 时的排序规则。<code>as rank_column</code> 用于指定生成的 Rank 排名列的别名。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。
请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式计算每个班级内的学生的分数排名（ranking）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>rank</span><span class=p>()</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>score</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>ranking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=开窗函数---row_number>开窗函数 - row_number<a hidden class=anchor aria-hidden=true href=#开窗函数---row_number>#</a></h4><p>Row_Number 开窗函数是 SQL 中的一种用于为查询结果集中的每一行 <strong>分配唯一连续排名</strong> 的开窗函数。</p><p>它与之前讲到的 Rank 函数不同，Row_Number 函数为每一行都分配一个唯一的整数值，不管是否存在并列（相同排序值）的情况。每一行都有一个唯一的行号，从 1 开始连续递增。</p><p>row_number 开窗函数的语法如下（几乎和 rank 函数一模一样）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>row_number</span><span class=p>()</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=c1>-- 可选，用于指定分组列
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>column3</span><span class=w> </span><span class=p>[</span><span class=k>asc</span><span class=o>|</span><span class=k>desc</span><span class=p>],</span><span class=w> </span><span class=n>column4</span><span class=w> </span><span class=p>[</span><span class=k>asc</span><span class=o>|</span><span class=k>desc</span><span class=p>],</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=c1>-- 用于指定排序列及排序方式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>row_number_column</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>其中，<code>PARTITION BY</code>子句可选，用于指定分组列，将结果集按照指定列进行分组。<code>ORDER BY</code> 子句用于指定排序列及排序方式，决定了计算 Row_Number 时的排序规则。<code>AS row_number_column</code> 用于指定生成的行号列的别名。</p><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。
请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式给每个班级内的学生分配一个编号（row_number）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nf>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	        </span><span class=n>score</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>row_number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>student</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=开窗函数---lag--lead>开窗函数 - lag / lead<a hidden class=anchor aria-hidden=true href=#开窗函数---lag--lead>#</a></h4><p>开窗函数 Lag 和 Lead 的作用是获取在当前行之前或之后的行的值，这两个函数通常在需要比较相邻行数据或进行时间序列分析时非常有用。</p><p>1）Lag 函数</p><p>Lag 函数用于获取 <strong>当前行之前</strong> 的某一列的值。它可以帮助我们查看上一行的数据。</p><p>Lag 函数的语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=nf>lag</span><span class=p>(</span><span class=n>column_name</span><span class=p>,</span><span class=w> </span><span class=n>offset</span><span class=p>,</span><span class=w> </span><span class=n>default_value</span><span class=p>)</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>partition_column</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>sort_column</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>参数解释：</p><ul><li><code>column_name</code>：要获取值的列名。</li><li><code>offset</code>：表示要向上偏移的行数。例如，offset为1表示获取上一行的值，offset为2表示获取上两行的值&mldr;</li><li><code>default_value</code>：可选参数，用于指定当没有前一行时的默认值。</li><li><code>PARTITION BY</code>和<code>ORDER BY</code>子句可选，用于分组和排序数据。</li></ul><p>2）Lead 函数</p><p>Lead 函数用于获取 <strong>当前行之后</strong> 的某一列的值。它可以帮助我们查看下一行的数据。</p><p>Lead 函数的语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=nf>lead</span><span class=p>(</span><span class=n>column_name</span><span class=p>,</span><span class=w> </span><span class=n>offset</span><span class=p>,</span><span class=w> </span><span class=n>default_value</span><span class=p>)</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>partition_column</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>sort_column</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>参数解释：</p><ul><li><code>column_name</code>：要获取值的列名。</li><li><code>offset</code>：表示要向下偏移的行数。例如，offset为1表示获取下一行的值，offset为2表示获取下两行的值&mldr;</li><li><code>default_value</code>：可选参数，用于指定当没有后一行时的默认值。</li><li><code>PARTITION BY</code>和<code>ORDER BY</code>子句可选，用于分组和排序数据。</li></ul><p>假设有一个学生表 <code>student</code>，包含以下字段：<code>id</code>（学号）、<code>name</code>（姓名）、<code>age</code>（年龄）、<code>score</code>（分数）、<code>class_id</code>（班级编号）。
请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式获取每个班级内的学生的前一名学生姓名（prev_name）、后一名学生姓名（next_name）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>class_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>lag</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=no>null</span><span class=p>)</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>score</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>prev_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>lead</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=no>null</span><span class=p>)</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>class_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>score</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>next_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=测验>测验<a hidden class=anchor aria-hidden=true href=#测验>#</a></h3><h4 id=冒险者和金币>冒险者和金币<a hidden class=anchor aria-hidden=true href=#冒险者和金币>#</a></h4><p>假设有一家冒险者公会，他们有一张名为 <code>rewards</code> 的表格，用于记录每个冒险者在各个任务中获得的金币奖励情况。</p><p>表格字段如下：</p><ul><li><code>adventurer_id</code>：冒险者ID，唯一标识每个冒险者。</li><li><code>adventurer_name</code>：冒险者姓名。</li><li><code>task_id</code>：任务ID，唯一标识每个任务。</li><li><code>task_name</code>：任务名称。</li><li><code>reward_coins</code>：冒险者在该任务中获得的金币奖励数量。</li></ul><p>请你编写一条 SQL 查询语句，依次输出每个冒险者的 id（<code>adventurer_id</code>）、冒险者姓名（<code>adventurer_name</code>）、获得的总金币奖励（<code>total_reward_coins</code>），并按照总金币奖励从高到低排序，其中只列出总金币奖励排名前 3 的冒险者。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>adventurer_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>adventurer_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nf>sum</span><span class=p>(</span><span class=n>reward_coins</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_reward_coins</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>rewards</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>adventurer_id</span><span class=p>,</span><span class=n>adventurer_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>total_reward_coins</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>limit</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=魔法学院>魔法学院<a hidden class=anchor aria-hidden=true href=#魔法学院>#</a></h4><p>假设有一家魔法学院，里面有许多学员在不同科目上进行学习和考试。请你设计一张名为<code>magic_scores</code>的表格，用于记录每位学员在不同科目中的考试成绩情况。表格字段如下：</p><ul><li><code>student_id</code>：学员ID，唯一标识每位学员。</li><li><code>student_name</code>：学员姓名。</li><li><code>subject_id</code>：科目ID，唯一标识每个科目。</li><li><code>subject_name</code>：科目名称。</li><li><code>score</code>：学员在该科目的考试成绩。</li></ul><p>请你编写一条 SQL 查询语句，依次输出每位学员的学院 ID（<code>student_id</code>）、学员姓名（<code>student_name</code>）、科目 ID（<code>subject_id</code>）、科目名称（<code>subject_name</code>）、学员在该科目的考试成绩（<code>score</code>）、该学员在每个科目中的成绩排名（<code>score_rank</code>），并将结果按照成绩从高到低进行排序。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>student_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>subject_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>subject_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>score</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nf>rank</span><span class=p>()</span><span class=w> </span><span class=nf>over</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>partition</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>subject_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>score</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>score_rank</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>magic_scores</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=大浪淘鸡>大浪淘鸡<a hidden class=anchor aria-hidden=true href=#大浪淘鸡>#</a></h4><p>在神秘的海岛上，有一只传说中的大浪淘鸡，它身躯高大威武，羽毛闪烁着神秘的光芒。岛上的居民都传说大浪淘鸡是海洋之神的化身，它能够操纵海浪，带来平静或狂暴的海洋。为了验证这个传说是否属实，岛上的居民决定对大浪淘鸡进行观测和记录。</p><p>有一张 <code>chicken_observation</code> 的表格，用于记录居民观测大浪淘鸡的信息。表格字段如下：</p><ul><li><code>observation_id</code>：观测记录ID，唯一标识每条观测记录</li><li><code>observer_name</code>：观测者姓名</li><li><code>observation_date</code>：观测日期</li><li><code>observation_location</code>：观测地点</li><li><code>wave_intensity</code>：观测到的海浪强度，用整数表示，数值越大，海浪越狂暴</li></ul><p>请你编写一条 SQL 查询语句，找出观测地点包含 &ldquo;大浪淘鸡&rdquo; 且海浪强度超过 5 的观测记录，并依次输出每位观测者的姓名（<code>observer_name</code>）、观测日期（<code>observation_date</code>）以及观测到的海浪强度（<code>wave_intensity</code>）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>observer_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>observation_date</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>wave_intensity</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>observation_location</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>chicken_observation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>(</span><span class=n>observation_location</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%大浪淘鸡%&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>and</span><span class=w> </span><span class=p>(</span><span class=n>wave_intensity</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>5</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>wave_intensity</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/>编程语言</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/interview/%E6%AF%8F%E5%A4%A9%E4%B8%80%E9%81%93%E9%9D%A2%E8%AF%95%E9%A2%98/202309-vue%E9%9D%A2%E8%AF%95%E9%A2%98/><span class=title>« Prev</span><br><span>vue面试题</span></a>
<a class=next href=https://bablvsj.github.io/posts/interview/%E6%AF%8F%E5%A4%A9%E4%B8%80%E9%81%93%E9%9D%A2%E8%AF%95%E9%A2%98/20230823-%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/><span class=title>Next »</span><br><span>深浅拷贝</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>本站由</span><img width=60 src=/images/upyun.png>提供CDN加速/云存储服务</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>