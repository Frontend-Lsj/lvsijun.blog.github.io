<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>39-事件的绑定和事件对象Event | Bablvsj&#39;s Blog</title>
<meta name="keywords" content="JavaScript">
<meta name="description" content="39-事件的绑定和事件对象Event - Bablvsj&#39;s Blog">
<meta name="author" content="">
<link rel="canonical" href="https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5525cc669fcb4f094a55bfc3ebfc5a6e73445e090010c66ab49c2cad14735f57.css" integrity="sha256-VSXMZp/LTwlKVb/D6/xabnNEXgkAEMZqtJwsrRRzX1c=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js" integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://bablvsj.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://bablvsj.github.io/img/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://bablvsj.github.io/img/Q.gif">
<link rel="apple-touch-icon" href="https://bablvsj.github.io/Q.gif">
<link rel="mask-icon" href="https://bablvsj.github.io/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="stylesheet" href="/css/syntax.css">


<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="39-事件的绑定和事件对象Event" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-01-01T17:11:35+08:00" />
<meta property="article:modified_time" content="2020-01-01T17:11:35+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="39-事件的绑定和事件对象Event"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "文章",
      "item": "https://bablvsj.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "39-事件的绑定和事件对象Event",
      "item": "https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "39-事件的绑定和事件对象Event",
  "name": "39-事件的绑定和事件对象Event",
  "description": "",
  "keywords": [
    "JavaScript"
  ],
  "articleBody": "绑定事件的两种方式/DOM事件的级别 我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这里讲一下绑定（注册）事件的两种方式，我们以onclick事件为例。\nDOM0的写法：onclick element.onclick = function () { } 举例：\n\u003cbody\u003e \u003cbutton\u003e点我\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName(\"button\")[0]; //这种事件绑定的方式，如果绑定多个，则后面的会覆盖掉前面的 btn.onclick = function () { console.log(\"事件1\"); } btn.onclick = function () { console.log(\"事件2\"); } \u003c/script\u003e \u003c/body\u003e 点击按钮后，上方代码的打印结果：\n事件2 我们可以看到，DOM对象.事件 = 函数的这种绑定事件的方式：一个元素的一个事件只能绑定一个响应函数。如果绑定了多个响应函数，则后者会覆盖前者。\nDOM2的写法：addEventListener（高版本浏览器） element.addEventListener('click', function () { }, false); 参数解释：\n参数1：事件名的字符串(注意，没有on)\n参数2：回调函数：当事件触发时，该函数会被执行\n参数3：true表示捕获阶段触发，false表示冒泡阶段触发（默认）。如果不写，则默认为false。【重要】\n举例：\n\u003cbody\u003e \u003cbutton\u003e按钮\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName(\"button\")[0]; // addEventListener: 事件监听器。 原事件被执行的时候，后面绑定的事件照样被执行 // 这种写法不存在响应函数被覆盖的情况。（更适合团队开发） btn.addEventListener(\"click\", fn1); btn.addEventListener(\"click\", fn2); function fn1() { console.log(\"事件1\"); } function fn2() { console.log(\"事件2\"); } \u003c/script\u003e \u003c/body\u003e 点击按钮后，上方代码的打印结果：\n事件1 事件2 我们可以看到，addEventListener()这种绑定事件的方式：\n一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。执行顺序是：事件被触发时，响应函数会按照函数的绑定顺序执行。\naddEventListener()中的this，是绑定事件的对象。\naddEventListener()不支持 IE8 及以下的浏览器。在IE8中可以使用attachEvent来绑定事件（详见下一小段）。\nDOM2的写法：attachEvent（IE8及以下版本浏览器） element.attachEvent('onclick', function () { }); 参数解释：\n参数1：事件名的字符串(注意，有on)\n参数2：回调函数：当事件触发时，该函数会被执行\n举例：\n\u003cbody\u003e \u003cbutton\u003e按钮\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName('button')[0]; btn.attachEvent('onclick', function() { console.log('事件1'); }); btn.attachEvent('onclick', function() { console.log('事件2'); }); \u003c/script\u003e \u003c/body\u003e 在低版本的IE浏览器上，点击按钮后，上方代码的打印结果：\n事件2 事件1 我们可以看到，attachEvent()这种绑定事件的方式：\n一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。注意：执行顺序是，后绑定的先执行。\nattachEvent()中的this，是window\n兼容性写法 上面的内容里，需要强调的是：\naddEventListener()中的this，是绑定事件的对象。\nattachEvent()中的this，是window。\n既然这两个写法的this不同，那么，有没有一种兼容性的写法可以确保这两种绑定方式的this是相同的呢？我们可以封装一下。代码如下：\n\u003cbody\u003e \u003cbutton\u003e按钮\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName('button')[0]; myBind(btn , \"click\" , function(){ alert(this); }); //定义一个函数，用来为指定元素绑定响应函数 /* * addEventListener()中的this，是绑定事件的对象 * attachEvent()中的this，是window * 需要统一两个方法this */ /* * 参数： * element 要绑定事件的对象 * eventStr 事件的字符串(不要on) * callback 回调函数 */ function myBind(element , eventStr , callback){ if(element.addEventListener){ //大部分浏览器兼容的方式 element.addEventListener(eventStr , callback , false); }else{ /* * this是谁，由调用方式决定 * callback.call(element) */ //IE8及以下 element.attachEvent(\"on\"+eventStr , function(){ //在匿名函数 function 中调用回调函数callback callback.call(element); }); } } \u003c/script\u003e \u003c/body\u003e 事件对象 当事件的响应函数被触发时，会产生一个事件对象event。浏览器每次都会将这个事件event作为实参传进之前的响应函数。\n这个对象中包含了与当前事件相关的一切信息。比如鼠标的坐标、键盘的哪个按键被按下、鼠标滚轮滚动的方向等。\n获取 event 对象（兼容性问题） 所有浏览器都支持event对象，但支持的方式不同。如下。\n（1）普通浏览器的写法是 event。比如：\n（2）ie 678 的写法是 window.event。此时，事件对象 event 是作为window对象的属性保存的。\n于是，我们可以采取一种兼容性的写法。如下：\nevent = event || window.event; // 兼容性写法 代码举例：\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead lang=\"en\"\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003e\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cscript\u003e //点击页面的任何部分 document.onclick = function (event) { event = event || window.event; ////兼容性写法 console.log(event); console.log(event.timeStamp); console.log(event.bubbles); console.log(event.button); console.log(event.pageX); console.log(event.pageY); console.log(event.screenX); console.log(event.screenY); console.log(event.target); console.log(event.type); console.log(event.clientX); console.log(event.clientY); } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e event 属性 event 有很多属性，比如：\n由于pageX 和 pageY的兼容性不好，我们可以这样做：\n鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。 Event举例 举例1：使 div 跟随鼠标移动 代码实现：\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\" /\u003e \u003ctitle\u003e\u003c/title\u003e \u003cstyle type=\"text/css\"\u003e #box1 { width: 100px; height: 100px; background-color: red; /* * 开启box1的绝对定位 */ position: absolute; } \u003c/style\u003e \u003cscript type=\"text/javascript\"\u003e window.onload = function() { /* * 使div可以跟随鼠标移动 */ //获取box1 var box1 = document.getElementById(\"box1\"); //给整个页面绑定：鼠标移动事件 document.onmousemove = function(event) { //兼容的方式获取event对象 event = event || window.event; // 鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。 var pagex = event.pageX || scroll().left + event.clientX; var pagey = event.pageY || scroll().top + event.clientY; // 设置div的偏移量（相对于整个页面） // 注意，如果想通过 style.left 来设置属性，一定要给 box1开启绝对定位。 box1.style.left = pagex + \"px\"; box1.style.top = pagey + \"px\"; }; }; // scroll 函数封装 function scroll() { return { //此函数的返回值是对象 left: window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop, right: window.pageXOffset || document.body.scrollLeft || document.documentElement.scrollLeft }; } \u003c/script\u003e \u003c/head\u003e \u003cbody style=\"height: 1000px;width: 2000px;\"\u003e \u003cdiv id=\"box1\"\u003e\u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 举例2：获取鼠标距离所在盒子的距离 关键点：\n鼠标距离所在盒子的距离 = 鼠标在整个页面的位置 - 所在盒子在整个页面的位置 代码演示：\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead lang=\"en\"\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003e\u003c/title\u003e \u003cstyle\u003e .box { width: 300px; height: 200px; padding-top: 100px; background-color: pink; margin: 100px; text-align: center; font: 18px/30px \"simsun\"; cursor: pointer; } \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"box\"\u003e \u003c/div\u003e \u003cscript src=\"animate.js\"\u003e\u003c/script\u003e \u003cscript\u003e //需求：鼠标进入盒子之后只要移动，哪怕1像素，随时显示鼠标在盒子中的坐标。 //技术点：新事件，onmousemove：在事件源上，哪怕鼠标移动1像素也会触动这个事件。 //一定程度上，模拟了定时器 //步骤： //1.老三步和新五步 //2.获取鼠标在整个页面的位置 //3.获取盒子在整个页面的位置 //4.用鼠标的位置减去盒子的位置赋值给盒子的内容。 //1.老三步和新五步 var div = document.getElementsByTagName(\"div\")[0]; div.onmousemove = function (event) { event = event || window.event; //2.获取鼠标在整个页面的位置 var pagex = event.pageX || scroll().left + event.clientX; var pagey = event.pageY || scroll().top + event.clientY; //3.获取盒子在整个页面的位置 // var xx = // var yy = //4.用鼠标的位置减去盒子的位置赋值给盒子的内容。 var targetx = pagex - div.offsetLeft; var targety = pagey - div.offsetTop; this.innerHTML = \"鼠标在盒子中的X坐标为：\" + targetx + \"px;\n鼠标在盒子中的Y坐标为：\" + targety + \"px;\" } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e 实现效果：\n举例3：商品放大镜 代码实现：\n（1）index.html:\n\u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead lang=\"en\"\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003e\u003c/title\u003e \u003cstyle\u003e * { margin: 0; padding: 0; } .box { width: 350px; height: 350px; margin: 100px; border: 1px solid #ccc; position: relative; } .big { width: 400px; height: 400px; position: absolute; top: 0; left: 360px; border: 1px solid #ccc; overflow: hidden; display: none; } /*mask的中文是：遮罩*/ .mask { width: 175px; height: 175px; background: rgba(255, 255, 0, 0.4); position: absolute; top: 0; left: 0; cursor: move; display: none; } .small { position: relative; } img { vertical-align: top; } \u003c/style\u003e \u003cscript src=\"tools.js\"\u003e\u003c/script\u003e \u003cscript\u003e window.onload = function () { //需求：鼠标放到小盒子上，让大盒子里面的图片和我们同步等比例移动。 //技术点：onmouseenter==onmouseover 第一个不冒泡 //技术点：onmouseleave==onmouseout 第一个不冒泡 //步骤： //1.鼠标放上去显示盒子，移开隐藏盒子。 //2.老三步和新五步（黄盒子跟随移动） //3.右侧的大图片，等比例移动。 //0.获取相关元素 var box = document.getElementsByClassName(\"box\")[0]; var small = box.firstElementChild || box.firstChild; var big = box.children[1]; var mask = small.children[1]; var bigImg = big.children[0]; //1.鼠标放上去显示盒子，移开隐藏盒子。(为小盒子绑定事件) small.onmouseenter = function () { //封装好方法调用：显示元素 show(mask); show(big); } small.onmouseleave = function () { //封装好方法调用：隐藏元素 hide(mask); hide(big); } //2.老三步和新五步（黄盒子跟随移动） //绑定的事件是onmousemove，而事件源是small(只要在小盒子上移动1像素，黄盒子也要跟随) small.onmousemove = function (event) { //新五步 event = event || window.event; //想要移动黄盒子，必须要知道鼠标在small小图中的位置。 var pagex = event.pageX || scroll().left + event.clientX; var pagey = event.pageY || scroll().top + event.clientY; //x：mask的left值，y：mask的top值。 var x = pagex - box.offsetLeft - mask.offsetWidth / 2; //除以2，可以保证鼠标mask的中间 var y = pagey - box.offsetTop - mask.offsetHeight / 2; //限制换盒子的范围 //left取值为大于0，小盒子的宽-mask的宽。 if (x \u003c 0) { x = 0; } if (x \u003e small.offsetWidth - mask.offsetWidth) { x = small.offsetWidth - mask.offsetWidth; } //top同理。 if (y \u003c 0) { y = 0; } if (y \u003e small.offsetHeight - mask.offsetHeight) { y = small.offsetHeight - mask.offsetHeight; } //移动黄盒子 console.log(small.offsetHeight); mask.style.left = x + \"px\"; mask.style.top = y + \"px\"; //3.右侧的大图片，等比例移动。 //如何移动大图片？等比例移动。 // 大图片/大盒子 = 小图片/mask盒子 // 大图片走的距离/mask走的距离 = （大图片-大盒子）/（小图片-黄盒子） // var bili = (bigImg.offsetWidth-big.offsetWidth)/(small.offsetWidth-mask.offsetWidth); //大图片走的距离/mask盒子都的距离 = 大图片/小图片 var bili = bigImg.offsetWidth / small.offsetWidth; var xx = bili * x; //知道比例，就可以移动大图片了 var yy = bili * y; bigImg.style.marginTop = -yy + \"px\"; bigImg.style.marginLeft = -xx + \"px\"; } } \u003c/script\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"box\"\u003e \u003cdiv class=\"small\"\u003e \u003cimg src=\"images/001.jpg\" alt=\"\"/\u003e \u003cdiv class=\"mask\"\u003e\u003c/div\u003e \u003c/div\u003e \u003cdiv class=\"big\"\u003e \u003cimg src=\"images/0001.jpg\" alt=\"\"/\u003e \u003c/div\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e （2）tools.js:\n/** * Created by smyhvae on 2018/02/03. */ //显示和隐藏 function show(ele) { ele.style.display = \"block\"; } function hide(ele) { ele.style.display = \"none\"; } function scroll() { // 开始封装自己的scrollTop if (window.pageYOffset != null) { // ie9+ 高版本浏览器 // 因为 window.pageYOffset 默认的是 0 所以这里需要判断 return { left: window.pageXOffset, top: window.pageYOffset } } else if (document.compatMode === \"CSS1Compat\") { // 标准浏览器 来判断有没有声明DTD return { left: document.documentElement.scrollLeft, top: document.documentElement.scrollTop } } return { // 未声明 DTD left: document.body.scrollLeft, top: document.body.scrollTop } } 效果演示：\n",
  "wordCount" : "3810",
  "inLanguage": "en",
  "datePublished": "2020-01-01T17:11:35+08:00",
  "dateModified": "2020-01-01T17:11:35+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Bablvsj's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://bablvsj.github.io/img/Q.gif"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://bablvsj.github.io" accesskey="h" title="Bablvsj&#39;s Blog (Alt + H)">Bablvsj&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://bablvsj.github.io/" title="主页">
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="https://bablvsj.github.io/archives/" title="时间轴">
                    <span>时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://bablvsj.github.io/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://bablvsj.github.io/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://bablvsj.github.io/search" title="🔍 (Alt &#43; /)" accesskey=/>
                    <span>🔍</span>
                </a>
            </li>
        </ul>
    </nav>
</header>


<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      39-事件的绑定和事件对象Event
    </h1>
    <div class="post-meta">
      
<div class="post-tags-meta">
    <a href="https://bablvsj.github.io/tags/javascript/">JavaScript</a>
</div>

8 min&nbsp;·&nbsp;<span title='2020-01-01 17:11:35 +0800 CST'>2020/01/01</span>


      
    </div>
    
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        
        <div class="inner"><ul>
                <li>
                    <a href="#%e7%bb%91%e5%ae%9a%e4%ba%8b%e4%bb%b6%e7%9a%84%e4%b8%a4%e7%a7%8d%e6%96%b9%e5%bc%8fdom%e4%ba%8b%e4%bb%b6%e7%9a%84%e7%ba%a7%e5%88%ab" aria-label="绑定事件的两种方式/DOM事件的级别">绑定事件的两种方式/DOM事件的级别</a><ul>
                        
                <li>
                    <a href="#dom0%e7%9a%84%e5%86%99%e6%b3%95onclick" aria-label="DOM0的写法：onclick">DOM0的写法：onclick</a></li>
                <li>
                    <a href="#dom2%e7%9a%84%e5%86%99%e6%b3%95addeventlistener%e9%ab%98%e7%89%88%e6%9c%ac%e6%b5%8f%e8%a7%88%e5%99%a8" aria-label="DOM2的写法：addEventListener（高版本浏览器）">DOM2的写法：addEventListener（高版本浏览器）</a></li>
                <li>
                    <a href="#dom2%e7%9a%84%e5%86%99%e6%b3%95attacheventie8%e5%8f%8a%e4%bb%a5%e4%b8%8b%e7%89%88%e6%9c%ac%e6%b5%8f%e8%a7%88%e5%99%a8" aria-label="DOM2的写法：attachEvent（IE8及以下版本浏览器）">DOM2的写法：attachEvent（IE8及以下版本浏览器）</a></li>
                <li>
                    <a href="#%e5%85%bc%e5%ae%b9%e6%80%a7%e5%86%99%e6%b3%95" aria-label="兼容性写法">兼容性写法</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%ba%8b%e4%bb%b6%e5%af%b9%e8%b1%a1" aria-label="事件对象">事件对象</a><ul>
                        
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96-event-%e5%af%b9%e8%b1%a1%e5%85%bc%e5%ae%b9%e6%80%a7%e9%97%ae%e9%a2%98" aria-label="获取 event 对象（兼容性问题）">获取 event 对象（兼容性问题）</a></li>
                <li>
                    <a href="#event-%e5%b1%9e%e6%80%a7" aria-label="event 属性">event 属性</a></li></ul>
                </li>
                <li>
                    <a href="#event%e4%b8%be%e4%be%8b" aria-label="Event举例">Event举例</a><ul>
                        
                <li>
                    <a href="#%e4%b8%be%e4%be%8b1%e4%bd%bf-div-%e8%b7%9f%e9%9a%8f%e9%bc%a0%e6%a0%87%e7%a7%bb%e5%8a%a8" aria-label="举例1：使 div 跟随鼠标移动">举例1：使 div 跟随鼠标移动</a></li>
                <li>
                    <a href="#%e4%b8%be%e4%be%8b2%e8%8e%b7%e5%8f%96%e9%bc%a0%e6%a0%87%e8%b7%9d%e7%a6%bb%e6%89%80%e5%9c%a8%e7%9b%92%e5%ad%90%e7%9a%84%e8%b7%9d%e7%a6%bb" aria-label="举例2：获取鼠标距离所在盒子的距离">举例2：获取鼠标距离所在盒子的距离</a></li>
                <li>
                    <a href="#%e4%b8%be%e4%be%8b3%e5%95%86%e5%93%81%e6%94%be%e5%a4%a7%e9%95%9c" aria-label="举例3：商品放大镜">举例3：商品放大镜</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h2 id="绑定事件的两种方式dom事件的级别">绑定事件的两种方式/DOM事件的级别<a hidden class="anchor" aria-hidden="true" href="#绑定事件的两种方式dom事件的级别">#</a></h2>
<p>我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这里讲一下绑定（注册）事件的两种方式，我们以onclick事件为例。</p>
<h3 id="dom0的写法onclick">DOM0的写法：onclick<a hidden class="anchor" aria-hidden="true" href="#dom0的写法onclick">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>    element.onclick <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">button</span>&gt;点我&lt;/<span style="color:#9d0006">button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#af3a03">var</span> btn <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementsByTagName(<span style="color:#79740e">&#34;button&#34;</span>)[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">//这种事件绑定的方式，如果绑定多个，则后面的会覆盖掉前面的
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    btn.onclick <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#79740e">&#34;事件1&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    btn.onclick <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#79740e">&#34;事件2&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">body</span>&gt;
</span></span></code></pre></div><p>点击按钮后，上方代码的打印结果：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>事件2
</span></span></code></pre></div><p>我们可以看到，<code>DOM对象.事件 =  函数</code>的这种绑定事件的方式：一个元素的一个事件只能绑定一个响应函数。如果绑定了多个响应函数，则后者会覆盖前者。</p>
<h3 id="dom2的写法addeventlistener高版本浏览器">DOM2的写法：addEventListener（高版本浏览器）<a hidden class="anchor" aria-hidden="true" href="#dom2的写法addeventlistener高版本浏览器">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>    element.addEventListener(<span style="color:#79740e">&#39;click&#39;</span>, <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }, <span style="color:#af3a03">false</span>);
</span></span></code></pre></div><p>参数解释：</p>
<ul>
<li>
<p>参数1：事件名的字符串(注意，没有on)</p>
</li>
<li>
<p>参数2：回调函数：当事件触发时，该函数会被执行</p>
</li>
<li>
<p>参数3：<strong>true表示捕获阶段触发，false表示冒泡阶段触发（默认）</strong>。如果不写，则默认为false。【重要】</p>
</li>
</ul>
<p>举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">button</span>&gt;按钮&lt;/<span style="color:#9d0006">button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#af3a03">var</span> btn <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementsByTagName(<span style="color:#79740e">&#34;button&#34;</span>)[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// addEventListener: 事件监听器。 原事件被执行的时候，后面绑定的事件照样被执行
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">// 这种写法不存在响应函数被覆盖的情况。（更适合团队开发）
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    btn.addEventListener(<span style="color:#79740e">&#34;click&#34;</span>, fn1);
</span></span><span style="display:flex;"><span>    btn.addEventListener(<span style="color:#79740e">&#34;click&#34;</span>, fn2);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#af3a03">function</span> fn1() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#79740e">&#34;事件1&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#af3a03">function</span> fn2() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#79740e">&#34;事件2&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">body</span>&gt;
</span></span></code></pre></div><p>点击按钮后，上方代码的打印结果：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    事件1
</span></span><span style="display:flex;"><span>    事件2
</span></span></code></pre></div><p>我们可以看到，<code>addEventListener()</code>这种绑定事件的方式：</p>
<ul>
<li>
<p>一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。<strong>执行顺序是</strong>：事件被触发时，响应函数会按照函数的绑定顺序执行。</p>
</li>
<li>
<p>addEventListener()中的this，是绑定事件的对象。</p>
</li>
<li>
<p><code>addEventListener()</code>不支持 IE8 及以下的浏览器。在IE8中可以使用<code>attachEvent</code>来绑定事件（详见下一小段）。</p>
</li>
</ul>
<h3 id="dom2的写法attacheventie8及以下版本浏览器">DOM2的写法：attachEvent（IE8及以下版本浏览器）<a hidden class="anchor" aria-hidden="true" href="#dom2的写法attacheventie8及以下版本浏览器">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>    element.attachEvent(<span style="color:#79740e">&#39;onclick&#39;</span>, <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    });
</span></span></code></pre></div><p>参数解释：</p>
<ul>
<li>
<p>参数1：事件名的字符串(注意，有on)</p>
</li>
<li>
<p>参数2：回调函数：当事件触发时，该函数会被执行</p>
</li>
</ul>
<p>举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">button</span>&gt;按钮&lt;/<span style="color:#9d0006">button</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">var</span> btn <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementsByTagName(<span style="color:#79740e">&#39;button&#39;</span>)[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            btn.attachEvent(<span style="color:#79740e">&#39;onclick&#39;</span>, <span style="color:#af3a03">function</span>() {
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#79740e">&#39;事件1&#39;</span>);
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            btn.attachEvent(<span style="color:#79740e">&#39;onclick&#39;</span>, <span style="color:#af3a03">function</span>() {
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#79740e">&#39;事件2&#39;</span>);
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">body</span>&gt;
</span></span></code></pre></div><p>在低版本的IE浏览器上，点击按钮后，上方代码的打印结果：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    事件2
</span></span><span style="display:flex;"><span>    事件1
</span></span></code></pre></div><p>我们可以看到，<code>attachEvent()</code>这种绑定事件的方式：</p>
<ul>
<li>
<p>一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。<strong>注意</strong>：执行顺序是，后绑定的先执行。</p>
</li>
<li>
<p>attachEvent()中的this，是window</p>
</li>
</ul>
<h3 id="兼容性写法">兼容性写法<a hidden class="anchor" aria-hidden="true" href="#兼容性写法">#</a></h3>
<p>上面的内容里，需要强调的是：</p>
<ul>
<li>
<p><code>addEventListener()</code>中的this，是绑定事件的对象。</p>
</li>
<li>
<p><code>attachEvent()</code>中的this，是window。</p>
</li>
</ul>
<p>既然这两个写法的<code>this</code>不同，那么，有没有一种兼容性的写法可以确保这两种绑定方式的this是相同的呢？我们可以封装一下。代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">button</span>&gt;按钮&lt;/<span style="color:#9d0006">button</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">var</span> btn <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementsByTagName(<span style="color:#79740e">&#39;button&#39;</span>)[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            myBind(btn , <span style="color:#79740e">&#34;click&#34;</span> , <span style="color:#af3a03">function</span>(){
</span></span><span style="display:flex;"><span>                alert(<span style="color:#af3a03">this</span>);
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#928374;font-style:italic">//定义一个函数，用来为指定元素绑定响应函数
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             * addEventListener()中的this，是绑定事件的对象
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             * attachEvent()中的this，是window
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             *  需要统一两个方法this
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#928374;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             * 参数：
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             *  element 要绑定事件的对象
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             *  eventStr 事件的字符串(不要on)
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             *  callback 回调函数
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">function</span> myBind(element , eventStr , callback){
</span></span><span style="display:flex;"><span>                <span style="color:#af3a03">if</span>(element.addEventListener){
</span></span><span style="display:flex;"><span>                    <span style="color:#928374;font-style:italic">//大部分浏览器兼容的方式
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                    element.addEventListener(eventStr , callback , <span style="color:#af3a03">false</span>);
</span></span><span style="display:flex;"><span>                }<span style="color:#af3a03">else</span>{
</span></span><span style="display:flex;"><span>                    <span style="color:#928374;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">                     * this是谁，由调用方式决定
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">                     * callback.call(element)
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">                     */</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#928374;font-style:italic">//IE8及以下
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                    element.attachEvent(<span style="color:#79740e">&#34;on&#34;</span><span style="color:#af3a03">+</span>eventStr , <span style="color:#af3a03">function</span>(){
</span></span><span style="display:flex;"><span>                        <span style="color:#928374;font-style:italic">//在匿名函数 function 中调用回调函数callback
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                        callback.call(element);
</span></span><span style="display:flex;"><span>                    });
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">body</span>&gt;
</span></span></code></pre></div><h2 id="事件对象">事件对象<a hidden class="anchor" aria-hidden="true" href="#事件对象">#</a></h2>
<p>当事件的响应函数被触发时，会产生一个事件对象<code>event</code>。浏览器每次都会将这个事件<code>event</code>作为实参传进之前的响应函数。</p>
<p>这个对象中包含了与当前事件相关的一切信息。比如鼠标的坐标、键盘的哪个按键被按下、鼠标滚轮滚动的方向等。</p>
<h3 id="获取-event-对象兼容性问题">获取 event 对象（兼容性问题）<a hidden class="anchor" aria-hidden="true" href="#获取-event-对象兼容性问题">#</a></h3>
<p>所有浏览器都支持event对象，但支持的方式不同。如下。</p>
<p>（1）普通浏览器的写法是 <code>event</code>。比如：</p>
<p><img loading="lazy" src="http://img.smyhvae.com/20180203_1735.png" alt=""  />
</p>
<p>（2）ie 678 的写法是 <code>window.event</code>。此时，事件对象 event 是作为window对象的属性保存的。</p>
<p>于是，我们可以采取一种兼容性的写法。如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>    event <span style="color:#af3a03">=</span> event <span style="color:#af3a03">||</span> <span style="color:#b57614">window</span>.event; <span style="color:#928374;font-style:italic">// 兼容性写法
</span></span></span></code></pre></div><p>代码举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#427b58">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">head</span> <span style="color:#79740e;font-weight:bold">lang</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">meta</span> <span style="color:#79740e;font-weight:bold">charset</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">title</span>&gt;&lt;/<span style="color:#9d0006">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">//点击页面的任何部分
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#b57614">document</span>.onclick <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> (event) {
</span></span><span style="display:flex;"><span>        event <span style="color:#af3a03">=</span> event <span style="color:#af3a03">||</span> <span style="color:#b57614">window</span>.event; <span style="color:#928374;font-style:italic">////兼容性写法
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>
</span></span><span style="display:flex;"><span>        console.log(event);
</span></span><span style="display:flex;"><span>        console.log(event.timeStamp);
</span></span><span style="display:flex;"><span>        console.log(event.bubbles);
</span></span><span style="display:flex;"><span>        console.log(event.button);
</span></span><span style="display:flex;"><span>        console.log(event.pageX);
</span></span><span style="display:flex;"><span>        console.log(event.pageY);
</span></span><span style="display:flex;"><span>        console.log(event.screenX);
</span></span><span style="display:flex;"><span>        console.log(event.screenY);
</span></span><span style="display:flex;"><span>        console.log(event.target);
</span></span><span style="display:flex;"><span>        console.log(event.type);
</span></span><span style="display:flex;"><span>        console.log(event.clientX);
</span></span><span style="display:flex;"><span>        console.log(event.clientY);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">html</span>&gt;
</span></span></code></pre></div><h3 id="event-属性">event 属性<a hidden class="anchor" aria-hidden="true" href="#event-属性">#</a></h3>
<p>event 有很多属性，比如：</p>
<p><img loading="lazy" src="http://img.smyhvae.com/20180203_1739.png" alt=""  />
</p>
<p>由于pageX 和 pageY的兼容性不好，我们可以这样做：</p>
<ul>
<li>鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。</li>
</ul>
<h2 id="event举例">Event举例<a hidden class="anchor" aria-hidden="true" href="#event举例">#</a></h2>
<h3 id="举例1使-div-跟随鼠标移动">举例1：使 div 跟随鼠标移动<a hidden class="anchor" aria-hidden="true" href="#举例1使-div-跟随鼠标移动">#</a></h3>
<p>代码实现：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#427b58">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#9d0006">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">meta</span> <span style="color:#79740e;font-weight:bold">charset</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;UTF-8&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">title</span>&gt;&lt;/<span style="color:#9d0006">title</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">style</span> <span style="color:#79740e;font-weight:bold">type</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;text/css&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      #box1 {
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">width</span>: <span style="color:#8f3f71">100</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">height</span>: <span style="color:#8f3f71">100</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">background-color</span>: <span style="color:#af3a03">red</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">        * 开启box1的绝对定位
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">        */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">position</span>: <span style="color:#af3a03">absolute</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">style</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">script</span> <span style="color:#79740e;font-weight:bold">type</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;text/javascript&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#b57614">window</span>.onload <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">         * 使div可以跟随鼠标移动
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">//获取box1
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#af3a03">var</span> box1 <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementById(<span style="color:#79740e">&#34;box1&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">//给整个页面绑定：鼠标移动事件
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#b57614">document</span>.onmousemove <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span>(event) {
</span></span><span style="display:flex;"><span>          <span style="color:#928374;font-style:italic">//兼容的方式获取event对象
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>          event <span style="color:#af3a03">=</span> event <span style="color:#af3a03">||</span> <span style="color:#b57614">window</span>.event;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#928374;font-style:italic">// 鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>          <span style="color:#af3a03">var</span> pagex <span style="color:#af3a03">=</span> event.pageX <span style="color:#af3a03">||</span> scroll().left <span style="color:#af3a03">+</span> event.clientX;
</span></span><span style="display:flex;"><span>          <span style="color:#af3a03">var</span> pagey <span style="color:#af3a03">=</span> event.pageY <span style="color:#af3a03">||</span> scroll().top <span style="color:#af3a03">+</span> event.clientY;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#928374;font-style:italic">//   设置div的偏移量（相对于整个页面）
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>          <span style="color:#928374;font-style:italic">// 注意，如果想通过 style.left 来设置属性，一定要给 box1开启绝对定位。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>          box1.style.left <span style="color:#af3a03">=</span> pagex <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px&#34;</span>;
</span></span><span style="display:flex;"><span>          box1.style.top <span style="color:#af3a03">=</span> pagey <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px&#34;</span>;
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#928374;font-style:italic">// scroll 函数封装
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>      <span style="color:#af3a03">function</span> scroll() {
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">return</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#928374;font-style:italic">//此函数的返回值是对象
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>          left<span style="color:#af3a03">:</span> <span style="color:#b57614">window</span>.pageYOffset <span style="color:#af3a03">||</span> <span style="color:#b57614">document</span>.body.scrollTop <span style="color:#af3a03">||</span> <span style="color:#b57614">document</span>.documentElement.scrollTop,
</span></span><span style="display:flex;"><span>          right<span style="color:#af3a03">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#b57614">window</span>.pageXOffset <span style="color:#af3a03">||</span> <span style="color:#b57614">document</span>.body.scrollLeft <span style="color:#af3a03">||</span> <span style="color:#b57614">document</span>.documentElement.scrollLeft
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#9d0006">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#9d0006">body</span> <span style="color:#79740e;font-weight:bold">style</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;height: 1000px;width: 2000px;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">div</span> <span style="color:#79740e;font-weight:bold">id</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;box1&#34;</span>&gt;&lt;/<span style="color:#9d0006">div</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">html</span>&gt;
</span></span></code></pre></div><h3 id="举例2获取鼠标距离所在盒子的距离">举例2：获取鼠标距离所在盒子的距离<a hidden class="anchor" aria-hidden="true" href="#举例2获取鼠标距离所在盒子的距离">#</a></h3>
<p>关键点：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>    鼠标距离所在盒子的距离 = 鼠标在整个页面的位置 - 所在盒子在整个页面的位置
</span></span></code></pre></div><p>代码演示：</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#427b58">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">head</span> <span style="color:#79740e;font-weight:bold">lang</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">meta</span> <span style="color:#79740e;font-weight:bold">charset</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">title</span>&gt;&lt;/<span style="color:#9d0006">title</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">style</span>&gt;
</span></span><span style="display:flex;"><span>        .box {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">width</span>: <span style="color:#8f3f71">300</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">height</span>: <span style="color:#8f3f71">200</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">padding-top</span>: <span style="color:#8f3f71">100</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">background-color</span>: <span style="color:#af3a03">pink</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">margin</span>: <span style="color:#8f3f71">100</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">text-align</span>: <span style="color:#af3a03">center</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">font</span>: <span style="color:#8f3f71">18</span><span style="color:#b57614">px</span><span style="color:#af3a03">/</span><span style="color:#8f3f71">30</span><span style="color:#b57614">px</span> <span style="color:#79740e">&#34;simsun&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">cursor</span>: <span style="color:#af3a03">pointer</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">style</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">div</span> <span style="color:#79740e;font-weight:bold">class</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;box&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">script</span> <span style="color:#79740e;font-weight:bold">src</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;animate.js&#34;</span>&gt;&lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">//需求：鼠标进入盒子之后只要移动，哪怕1像素，随时显示鼠标在盒子中的坐标。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//技术点：新事件，onmousemove：在事件源上，哪怕鼠标移动1像素也会触动这个事件。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//一定程度上，模拟了定时器
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//步骤：
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//1.老三步和新五步
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//2.获取鼠标在整个页面的位置
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//3.获取盒子在整个页面的位置
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#928374;font-style:italic">//4.用鼠标的位置减去盒子的位置赋值给盒子的内容。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">//1.老三步和新五步
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#af3a03">var</span> div <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementsByTagName(<span style="color:#79740e">&#34;div&#34;</span>)[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    div.onmousemove <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> (event) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        event <span style="color:#af3a03">=</span> event <span style="color:#af3a03">||</span> <span style="color:#b57614">window</span>.event;
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">//2.获取鼠标在整个页面的位置
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#af3a03">var</span> pagex <span style="color:#af3a03">=</span> event.pageX <span style="color:#af3a03">||</span> scroll().left <span style="color:#af3a03">+</span> event.clientX;
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">var</span> pagey <span style="color:#af3a03">=</span> event.pageY <span style="color:#af3a03">||</span> scroll().top <span style="color:#af3a03">+</span> event.clientY;
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">//3.获取盒子在整个页面的位置
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#928374;font-style:italic">// var xx =
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#928374;font-style:italic">// var yy =
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#928374;font-style:italic">//4.用鼠标的位置减去盒子的位置赋值给盒子的内容。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#af3a03">var</span> targetx <span style="color:#af3a03">=</span> pagex <span style="color:#af3a03">-</span> div.offsetLeft;
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">var</span> targety <span style="color:#af3a03">=</span> pagey <span style="color:#af3a03">-</span> div.offsetTop;
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">this</span>.innerHTML <span style="color:#af3a03">=</span> <span style="color:#79740e">&#34;鼠标在盒子中的X坐标为：&#34;</span> <span style="color:#af3a03">+</span> targetx <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px;&lt;br&gt;鼠标在盒子中的Y坐标为：&#34;</span> <span style="color:#af3a03">+</span> targety <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px;&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">html</span>&gt;
</span></span></code></pre></div><p>实现效果：</p>
<p><img loading="lazy" src="http://img.smyhvae.com/20180203_1828.gif" alt=""  />
</p>
<h3 id="举例3商品放大镜">举例3：商品放大镜<a hidden class="anchor" aria-hidden="true" href="#举例3商品放大镜">#</a></h3>
<p>代码实现：</p>
<p>（1）index.html:</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#427b58">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">head</span> <span style="color:#79740e;font-weight:bold">lang</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">meta</span> <span style="color:#79740e;font-weight:bold">charset</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">title</span>&gt;&lt;/<span style="color:#9d0006">title</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">style</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#af3a03">*</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">margin</span>: <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">padding</span>: <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        .box {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">width</span>: <span style="color:#8f3f71">350</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">height</span>: <span style="color:#8f3f71">350</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">margin</span>: <span style="color:#8f3f71">100</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">border</span>: <span style="color:#8f3f71">1</span><span style="color:#b57614">px</span> <span style="color:#af3a03">solid</span> <span style="color:#8f3f71">#ccc</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">position</span>: <span style="color:#af3a03">relative</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        .big {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">width</span>: <span style="color:#8f3f71">400</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">height</span>: <span style="color:#8f3f71">400</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">position</span>: <span style="color:#af3a03">absolute</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">top</span>: <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">left</span>: <span style="color:#8f3f71">360</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">border</span>: <span style="color:#8f3f71">1</span><span style="color:#b57614">px</span> <span style="color:#af3a03">solid</span> <span style="color:#8f3f71">#ccc</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">overflow</span>: <span style="color:#af3a03">hidden</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">display</span>: <span style="color:#af3a03">none</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#928374;font-style:italic">/*mask的中文是：遮罩*/</span>
</span></span><span style="display:flex;"><span>        .mask {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">width</span>: <span style="color:#8f3f71">175</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">height</span>: <span style="color:#8f3f71">175</span><span style="color:#b57614">px</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">background</span>: <span style="color:#b57614">rgba</span>(<span style="color:#8f3f71">255</span>, <span style="color:#8f3f71">255</span>, <span style="color:#8f3f71">0</span>, <span style="color:#8f3f71">0.4</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">position</span>: <span style="color:#af3a03">absolute</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">top</span>: <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">left</span>: <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">cursor</span>: <span style="color:#af3a03">move</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">display</span>: <span style="color:#af3a03">none</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        .small {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">position</span>: <span style="color:#af3a03">relative</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#9d0006">img</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">vertical-align</span>: <span style="color:#af3a03">top</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">style</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">script</span> <span style="color:#79740e;font-weight:bold">src</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;tools.js&#34;</span>&gt;&lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#b57614">window</span>.onload <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>            <span style="color:#928374;font-style:italic">//需求：鼠标放到小盒子上，让大盒子里面的图片和我们同步等比例移动。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//技术点：onmouseenter==onmouseover 第一个不冒泡
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//技术点：onmouseleave==onmouseout  第一个不冒泡
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//步骤：
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//1.鼠标放上去显示盒子，移开隐藏盒子。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//2.老三步和新五步（黄盒子跟随移动）
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//3.右侧的大图片，等比例移动。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>
</span></span><span style="display:flex;"><span>            <span style="color:#928374;font-style:italic">//0.获取相关元素
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#af3a03">var</span> box <span style="color:#af3a03">=</span> <span style="color:#b57614">document</span>.getElementsByClassName(<span style="color:#79740e">&#34;box&#34;</span>)[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">var</span> small <span style="color:#af3a03">=</span> box.firstElementChild <span style="color:#af3a03">||</span> box.firstChild;
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">var</span> big <span style="color:#af3a03">=</span> box.children[<span style="color:#8f3f71">1</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">var</span> mask <span style="color:#af3a03">=</span> small.children[<span style="color:#8f3f71">1</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#af3a03">var</span> bigImg <span style="color:#af3a03">=</span> big.children[<span style="color:#8f3f71">0</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#928374;font-style:italic">//1.鼠标放上去显示盒子，移开隐藏盒子。(为小盒子绑定事件)
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            small.onmouseenter <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//封装好方法调用：显示元素
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                show(mask);
</span></span><span style="display:flex;"><span>                show(big);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            small.onmouseleave <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> () {
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//封装好方法调用：隐藏元素
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                hide(mask);
</span></span><span style="display:flex;"><span>                hide(big);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#928374;font-style:italic">//2.老三步和新五步（黄盒子跟随移动）
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            <span style="color:#928374;font-style:italic">//绑定的事件是onmousemove，而事件源是small(只要在小盒子上移动1像素，黄盒子也要跟随)
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>            small.onmousemove <span style="color:#af3a03">=</span> <span style="color:#af3a03">function</span> (event) {
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//新五步
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                event <span style="color:#af3a03">=</span> event <span style="color:#af3a03">||</span> <span style="color:#b57614">window</span>.event;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//想要移动黄盒子，必须要知道鼠标在small小图中的位置。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">var</span> pagex <span style="color:#af3a03">=</span> event.pageX <span style="color:#af3a03">||</span> scroll().left <span style="color:#af3a03">+</span> event.clientX;
</span></span><span style="display:flex;"><span>                <span style="color:#af3a03">var</span> pagey <span style="color:#af3a03">=</span> event.pageY <span style="color:#af3a03">||</span> scroll().top <span style="color:#af3a03">+</span> event.clientY;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//x：mask的left值，y：mask的top值。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">var</span> x <span style="color:#af3a03">=</span> pagex <span style="color:#af3a03">-</span> box.offsetLeft <span style="color:#af3a03">-</span> mask.offsetWidth <span style="color:#af3a03">/</span> <span style="color:#8f3f71">2</span>; <span style="color:#928374;font-style:italic">//除以2，可以保证鼠标mask的中间
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">var</span> y <span style="color:#af3a03">=</span> pagey <span style="color:#af3a03">-</span> box.offsetTop <span style="color:#af3a03">-</span> mask.offsetHeight <span style="color:#af3a03">/</span> <span style="color:#8f3f71">2</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//限制换盒子的范围
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#928374;font-style:italic">//left取值为大于0，小盒子的宽-mask的宽。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">if</span> (x <span style="color:#af3a03">&lt;</span> <span style="color:#8f3f71">0</span>) {
</span></span><span style="display:flex;"><span>                    x <span style="color:#af3a03">=</span> <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#af3a03">if</span> (x <span style="color:#af3a03">&gt;</span> small.offsetWidth <span style="color:#af3a03">-</span> mask.offsetWidth) {
</span></span><span style="display:flex;"><span>                    x <span style="color:#af3a03">=</span> small.offsetWidth <span style="color:#af3a03">-</span> mask.offsetWidth;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//top同理。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">if</span> (y <span style="color:#af3a03">&lt;</span> <span style="color:#8f3f71">0</span>) {
</span></span><span style="display:flex;"><span>                    y <span style="color:#af3a03">=</span> <span style="color:#8f3f71">0</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#af3a03">if</span> (y <span style="color:#af3a03">&gt;</span> small.offsetHeight <span style="color:#af3a03">-</span> mask.offsetHeight) {
</span></span><span style="display:flex;"><span>                    y <span style="color:#af3a03">=</span> small.offsetHeight <span style="color:#af3a03">-</span> mask.offsetHeight;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//移动黄盒子
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                console.log(small.offsetHeight);
</span></span><span style="display:flex;"><span>                mask.style.left <span style="color:#af3a03">=</span> x <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px&#34;</span>;
</span></span><span style="display:flex;"><span>                mask.style.top <span style="color:#af3a03">=</span> y <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//3.右侧的大图片，等比例移动。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#928374;font-style:italic">//如何移动大图片？等比例移动。
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#928374;font-style:italic">//    大图片/大盒子 = 小图片/mask盒子
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#928374;font-style:italic">//    大图片走的距离/mask走的距离 = （大图片-大盒子）/（小图片-黄盒子）
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">//                var bili = (bigImg.offsetWidth-big.offsetWidth)/(small.offsetWidth-mask.offsetWidth);
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#928374;font-style:italic">//大图片走的距离/mask盒子都的距离 = 大图片/小图片
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">var</span> bili <span style="color:#af3a03">=</span> bigImg.offsetWidth <span style="color:#af3a03">/</span> small.offsetWidth;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#af3a03">var</span> xx <span style="color:#af3a03">=</span> bili <span style="color:#af3a03">*</span> x;  <span style="color:#928374;font-style:italic">//知道比例，就可以移动大图片了
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>                <span style="color:#af3a03">var</span> yy <span style="color:#af3a03">=</span> bili <span style="color:#af3a03">*</span> y;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                bigImg.style.marginTop <span style="color:#af3a03">=</span> <span style="color:#af3a03">-</span>yy <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px&#34;</span>;
</span></span><span style="display:flex;"><span>                bigImg.style.marginLeft <span style="color:#af3a03">=</span> <span style="color:#af3a03">-</span>xx <span style="color:#af3a03">+</span> <span style="color:#79740e">&#34;px&#34;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#9d0006">div</span> <span style="color:#79740e;font-weight:bold">class</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;box&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">div</span> <span style="color:#79740e;font-weight:bold">class</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;small&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">img</span> <span style="color:#79740e;font-weight:bold">src</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;images/001.jpg&#34;</span> <span style="color:#79740e;font-weight:bold">alt</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">div</span> <span style="color:#79740e;font-weight:bold">class</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;mask&#34;</span>&gt;&lt;/<span style="color:#9d0006">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#9d0006">div</span> <span style="color:#79740e;font-weight:bold">class</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;big&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#9d0006">img</span> <span style="color:#79740e;font-weight:bold">src</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;images/0001.jpg&#34;</span> <span style="color:#79740e;font-weight:bold">alt</span><span style="color:#af3a03">=</span><span style="color:#79740e">&#34;&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#9d0006">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#9d0006">html</span>&gt;
</span></span></code></pre></div><p>（2）tools.js:</p>
<div class="highlight"><pre tabindex="0" style="color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#928374;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"> * Created by smyhvae on 2018/02/03.
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"> */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">//显示和隐藏
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span><span style="color:#af3a03">function</span> show(ele) {
</span></span><span style="display:flex;"><span>    ele.style.display <span style="color:#af3a03">=</span> <span style="color:#79740e">&#34;block&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#af3a03">function</span> hide(ele) {
</span></span><span style="display:flex;"><span>    ele.style.display <span style="color:#af3a03">=</span> <span style="color:#79740e">&#34;none&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#af3a03">function</span> scroll() {  <span style="color:#928374;font-style:italic">// 开始封装自己的scrollTop
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    <span style="color:#af3a03">if</span> (<span style="color:#b57614">window</span>.pageYOffset <span style="color:#af3a03">!=</span> <span style="color:#af3a03">null</span>) {  <span style="color:#928374;font-style:italic">// ie9+ 高版本浏览器
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#928374;font-style:italic">// 因为 window.pageYOffset 默认的是  0  所以这里需要判断
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#af3a03">return</span> {
</span></span><span style="display:flex;"><span>            left<span style="color:#af3a03">:</span> <span style="color:#b57614">window</span>.pageXOffset,
</span></span><span style="display:flex;"><span>            top<span style="color:#af3a03">:</span> <span style="color:#b57614">window</span>.pageYOffset
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#af3a03">else</span> <span style="color:#af3a03">if</span> (<span style="color:#b57614">document</span>.compatMode <span style="color:#af3a03">===</span> <span style="color:#79740e">&#34;CSS1Compat&#34;</span>) {    <span style="color:#928374;font-style:italic">// 标准浏览器   来判断有没有声明DTD
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        <span style="color:#af3a03">return</span> {
</span></span><span style="display:flex;"><span>            left<span style="color:#af3a03">:</span> <span style="color:#b57614">document</span>.documentElement.scrollLeft,
</span></span><span style="display:flex;"><span>            top<span style="color:#af3a03">:</span> <span style="color:#b57614">document</span>.documentElement.scrollTop
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#af3a03">return</span> {   <span style="color:#928374;font-style:italic">// 未声明 DTD
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>        left<span style="color:#af3a03">:</span> <span style="color:#b57614">document</span>.body.scrollLeft,
</span></span><span style="display:flex;"><span>        top<span style="color:#af3a03">:</span> <span style="color:#b57614">document</span>.body.scrollTop
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>效果演示：</p>
<p><img loading="lazy" src="http://img.smyhvae.com/20180203_1920.gif" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://bablvsj.github.io/tags/javascript/">JavaScript</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://bablvsj.github.io/posts/tech/wait/04-javascript/38-client%E5%8F%AF%E8%A7%86%E5%8C%BA%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7/">
    <span class="title">« Prev</span>
    <br>
    <span>38-client(可视区)相关属性</span>
  </a>
  <a class="next" href="https://bablvsj.github.io/posts/tech/wait/04-javascript/40-%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BC%A0%E6%92%AD%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1/">
    <span class="title">Next »</span>
    <br>
    <span>40-事件的传播和事件冒泡</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://bablvsj.github.io">Bablvsj&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <div class="flex-c-d">
        <a class="flex-d-c" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"
            target="_blank"> <span>本站由</span><img width="60" src="/images/upyun.png">提供CDN加速/云存储服务</a>
    </div>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script></body>

</html>
