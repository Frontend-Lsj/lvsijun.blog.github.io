<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>39-事件的绑定和事件对象Event | Bablvsj's Blog</title><meta name=keywords content="JavaScript"><meta name=description content="绑定事件的两种方式/DOM事件的级别 我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这"><meta name=author content><link rel=canonical href=https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/><link crossorigin=anonymous href=/assets/css/stylesheet.89e53fb10d7090a33517d83b18da1cdb3f4d7bfa546525e8b3cf5a41f9817fb5.css integrity="sha256-ieU/sQ1wkKM1F9g7GNoc2z9Ne/pUZSXos89aQfmBf7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="39-事件的绑定和事件对象Event"><meta property="og:description" content="绑定事件的两种方式/DOM事件的级别 我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这"><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-01-01T17:11:35+08:00"><meta property="article:modified_time" content="2020-01-01T17:11:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="39-事件的绑定和事件对象Event"><meta name=twitter:description content="绑定事件的两种方式/DOM事件的级别 我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"文章","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"39-事件的绑定和事件对象Event","item":"https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"39-事件的绑定和事件对象Event","name":"39-事件的绑定和事件对象Event","description":"绑定事件的两种方式/DOM事件的级别 我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这","keywords":["JavaScript"],"articleBody":"绑定事件的两种方式/DOM事件的级别 我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这里讲一下绑定（注册）事件的两种方式，我们以onclick事件为例。\nDOM0的写法：onclick 1 2 3 element.onclick = function () { } 举例：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003cbody\u003e \u003cbutton\u003e点我\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName(\"button\")[0]; //这种事件绑定的方式，如果绑定多个，则后面的会覆盖掉前面的 btn.onclick = function () { console.log(\"事件1\"); } btn.onclick = function () { console.log(\"事件2\"); } \u003c/script\u003e \u003c/body\u003e 点击按钮后，上方代码的打印结果：\n1 事件2 我们可以看到，DOM对象.事件 = 函数的这种绑定事件的方式：一个元素的一个事件只能绑定一个响应函数。如果绑定了多个响应函数，则后者会覆盖前者。\nDOM2的写法：addEventListener（高版本浏览器） 1 2 3 element.addEventListener('click', function () { }, false); 参数解释：\n参数1：事件名的字符串(注意，没有on)\n参数2：回调函数：当事件触发时，该函数会被执行\n参数3：true表示捕获阶段触发，false表示冒泡阶段触发（默认）。如果不写，则默认为false。【重要】\n举例：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u003cbody\u003e \u003cbutton\u003e按钮\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName(\"button\")[0]; // addEventListener: 事件监听器。 原事件被执行的时候，后面绑定的事件照样被执行 // 这种写法不存在响应函数被覆盖的情况。（更适合团队开发） btn.addEventListener(\"click\", fn1); btn.addEventListener(\"click\", fn2); function fn1() { console.log(\"事件1\"); } function fn2() { console.log(\"事件2\"); } \u003c/script\u003e \u003c/body\u003e 点击按钮后，上方代码的打印结果：\n1 2 事件1 事件2 我们可以看到，addEventListener()这种绑定事件的方式：\n一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。执行顺序是：事件被触发时，响应函数会按照函数的绑定顺序执行。\naddEventListener()中的this，是绑定事件的对象。\naddEventListener()不支持 IE8 及以下的浏览器。在IE8中可以使用attachEvent来绑定事件（详见下一小段）。\nDOM2的写法：attachEvent（IE8及以下版本浏览器） 1 2 3 element.attachEvent('onclick', function () { }); 参数解释：\n参数1：事件名的字符串(注意，有on)\n参数2：回调函数：当事件触发时，该函数会被执行\n举例：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u003cbody\u003e \u003cbutton\u003e按钮\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName('button')[0]; btn.attachEvent('onclick', function() { console.log('事件1'); }); btn.attachEvent('onclick', function() { console.log('事件2'); }); \u003c/script\u003e \u003c/body\u003e 在低版本的IE浏览器上，点击按钮后，上方代码的打印结果：\n1 2 事件2 事件1 我们可以看到，attachEvent()这种绑定事件的方式：\n一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。注意：执行顺序是，后绑定的先执行。\nattachEvent()中的this，是window\n兼容性写法 上面的内容里，需要强调的是：\naddEventListener()中的this，是绑定事件的对象。\nattachEvent()中的this，是window。\n既然这两个写法的this不同，那么，有没有一种兼容性的写法可以确保这两种绑定方式的this是相同的呢？我们可以封装一下。代码如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 \u003cbody\u003e \u003cbutton\u003e按钮\u003c/button\u003e \u003cscript\u003e var btn = document.getElementsByTagName('button')[0]; myBind(btn , \"click\" , function(){ alert(this); }); //定义一个函数，用来为指定元素绑定响应函数 /* * addEventListener()中的this，是绑定事件的对象 * attachEvent()中的this，是window * 需要统一两个方法this */ /* * 参数： * element 要绑定事件的对象 * eventStr 事件的字符串(不要on) * callback 回调函数 */ function myBind(element , eventStr , callback){ if(element.addEventListener){ //大部分浏览器兼容的方式 element.addEventListener(eventStr , callback , false); }else{ /* * this是谁，由调用方式决定 * callback.call(element) */ //IE8及以下 element.attachEvent(\"on\"+eventStr , function(){ //在匿名函数 function 中调用回调函数callback callback.call(element); }); } } \u003c/script\u003e \u003c/body\u003e 事件对象 当事件的响应函数被触发时，会产生一个事件对象event。浏览器每次都会将这个事件event作为实参传进之前的响应函数。\n这个对象中包含了与当前事件相关的一切信息。比如鼠标的坐标、键盘的哪个按键被按下、鼠标滚轮滚动的方向等。\n获取 event 对象（兼容性问题） 所有浏览器都支持event对象，但支持的方式不同。如下。\n（1）普通浏览器的写法是 event。比如：\n（2）ie 678 的写法是 window.event。此时，事件对象 event 是作为window对象的属性保存的。\n于是，我们可以采取一种兼容性的写法。如下：\n1 event = event || window.event; // 兼容性写法 代码举例：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead lang=\"en\"\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003e\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cscript\u003e //点击页面的任何部分 document.onclick = function (event) { event = event || window.event; ////兼容性写法 console.log(event); console.log(event.timeStamp); console.log(event.bubbles); console.log(event.button); console.log(event.pageX); console.log(event.pageY); console.log(event.screenX); console.log(event.screenY); console.log(event.target); console.log(event.type); console.log(event.clientX); console.log(event.clientY); } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e event 属性 event 有很多属性，比如：\n由于pageX 和 pageY的兼容性不好，我们可以这样做：\n鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。 Event举例 举例1：使 div 跟随鼠标移动 代码实现：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\" /\u003e \u003ctitle\u003e\u003c/title\u003e \u003cstyle type=\"text/css\"\u003e #box1 { width: 100px; height: 100px; background-color: red; /* * 开启box1的绝对定位 */ position: absolute; } \u003c/style\u003e \u003cscript type=\"text/javascript\"\u003e window.onload = function() { /* * 使div可以跟随鼠标移动 */ //获取box1 var box1 = document.getElementById(\"box1\"); //给整个页面绑定：鼠标移动事件 document.onmousemove = function(event) { //兼容的方式获取event对象 event = event || window.event; // 鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。 var pagex = event.pageX || scroll().left + event.clientX; var pagey = event.pageY || scroll().top + event.clientY; // 设置div的偏移量（相对于整个页面） // 注意，如果想通过 style.left 来设置属性，一定要给 box1开启绝对定位。 box1.style.left = pagex + \"px\"; box1.style.top = pagey + \"px\"; }; }; // scroll 函数封装 function scroll() { return { //此函数的返回值是对象 left: window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop, right: window.pageXOffset || document.body.scrollLeft || document.documentElement.scrollLeft }; } \u003c/script\u003e \u003c/head\u003e \u003cbody style=\"height: 1000px;width: 2000px;\"\u003e \u003cdiv id=\"box1\"\u003e\u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 举例2：获取鼠标距离所在盒子的距离 关键点：\n1 鼠标距离所在盒子的距离 = 鼠标在整个页面的位置 - 所在盒子在整个页面的位置 代码演示：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead lang=\"en\"\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003e\u003c/title\u003e \u003cstyle\u003e .box { width: 300px; height: 200px; padding-top: 100px; background-color: pink; margin: 100px; text-align: center; font: 18px/30px \"simsun\"; cursor: pointer; } \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"box\"\u003e \u003c/div\u003e \u003cscript src=\"animate.js\"\u003e\u003c/script\u003e \u003cscript\u003e //需求：鼠标进入盒子之后只要移动，哪怕1像素，随时显示鼠标在盒子中的坐标。 //技术点：新事件，onmousemove：在事件源上，哪怕鼠标移动1像素也会触动这个事件。 //一定程度上，模拟了定时器 //步骤： //1.老三步和新五步 //2.获取鼠标在整个页面的位置 //3.获取盒子在整个页面的位置 //4.用鼠标的位置减去盒子的位置赋值给盒子的内容。 //1.老三步和新五步 var div = document.getElementsByTagName(\"div\")[0]; div.onmousemove = function (event) { event = event || window.event; //2.获取鼠标在整个页面的位置 var pagex = event.pageX || scroll().left + event.clientX; var pagey = event.pageY || scroll().top + event.clientY; //3.获取盒子在整个页面的位置 // var xx = // var yy = //4.用鼠标的位置减去盒子的位置赋值给盒子的内容。 var targetx = pagex - div.offsetLeft; var targety = pagey - div.offsetTop; this.innerHTML = \"鼠标在盒子中的X坐标为：\" + targetx + \"px;\n鼠标在盒子中的Y坐标为：\" + targety + \"px;\" } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e 实现效果：\n举例3：商品放大镜 代码实现：\n（1）index.html:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead lang=\"en\"\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003ctitle\u003e\u003c/title\u003e \u003cstyle\u003e * { margin: 0; padding: 0; } .box { width: 350px; height: 350px; margin: 100px; border: 1px solid #ccc; position: relative; } .big { width: 400px; height: 400px; position: absolute; top: 0; left: 360px; border: 1px solid #ccc; overflow: hidden; display: none; } /*mask的中文是：遮罩*/ .mask { width: 175px; height: 175px; background: rgba(255, 255, 0, 0.4); position: absolute; top: 0; left: 0; cursor: move; display: none; } .small { position: relative; } img { vertical-align: top; } \u003c/style\u003e \u003cscript src=\"tools.js\"\u003e\u003c/script\u003e \u003cscript\u003e window.onload = function () { //需求：鼠标放到小盒子上，让大盒子里面的图片和我们同步等比例移动。 //技术点：onmouseenter==onmouseover 第一个不冒泡 //技术点：onmouseleave==onmouseout 第一个不冒泡 //步骤： //1.鼠标放上去显示盒子，移开隐藏盒子。 //2.老三步和新五步（黄盒子跟随移动） //3.右侧的大图片，等比例移动。 //0.获取相关元素 var box = document.getElementsByClassName(\"box\")[0]; var small = box.firstElementChild || box.firstChild; var big = box.children[1]; var mask = small.children[1]; var bigImg = big.children[0]; //1.鼠标放上去显示盒子，移开隐藏盒子。(为小盒子绑定事件) small.onmouseenter = function () { //封装好方法调用：显示元素 show(mask); show(big); } small.onmouseleave = function () { //封装好方法调用：隐藏元素 hide(mask); hide(big); } //2.老三步和新五步（黄盒子跟随移动） //绑定的事件是onmousemove，而事件源是small(只要在小盒子上移动1像素，黄盒子也要跟随) small.onmousemove = function (event) { //新五步 event = event || window.event; //想要移动黄盒子，必须要知道鼠标在small小图中的位置。 var pagex = event.pageX || scroll().left + event.clientX; var pagey = event.pageY || scroll().top + event.clientY; //x：mask的left值，y：mask的top值。 var x = pagex - box.offsetLeft - mask.offsetWidth / 2; //除以2，可以保证鼠标mask的中间 var y = pagey - box.offsetTop - mask.offsetHeight / 2; //限制换盒子的范围 //left取值为大于0，小盒子的宽-mask的宽。 if (x \u003c 0) { x = 0; } if (x \u003e small.offsetWidth - mask.offsetWidth) { x = small.offsetWidth - mask.offsetWidth; } //top同理。 if (y \u003c 0) { y = 0; } if (y \u003e small.offsetHeight - mask.offsetHeight) { y = small.offsetHeight - mask.offsetHeight; } //移动黄盒子 console.log(small.offsetHeight); mask.style.left = x + \"px\"; mask.style.top = y + \"px\"; //3.右侧的大图片，等比例移动。 //如何移动大图片？等比例移动。 // 大图片/大盒子 = 小图片/mask盒子 // 大图片走的距离/mask走的距离 = （大图片-大盒子）/（小图片-黄盒子） // var bili = (bigImg.offsetWidth-big.offsetWidth)/(small.offsetWidth-mask.offsetWidth); //大图片走的距离/mask盒子都的距离 = 大图片/小图片 var bili = bigImg.offsetWidth / small.offsetWidth; var xx = bili * x; //知道比例，就可以移动大图片了 var yy = bili * y; bigImg.style.marginTop = -yy + \"px\"; bigImg.style.marginLeft = -xx + \"px\"; } } \u003c/script\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"box\"\u003e \u003cdiv class=\"small\"\u003e \u003cimg src=\"images/001.jpg\" alt=\"\"/\u003e \u003cdiv class=\"mask\"\u003e\u003c/div\u003e \u003c/div\u003e \u003cdiv class=\"big\"\u003e \u003cimg src=\"images/0001.jpg\" alt=\"\"/\u003e \u003c/div\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e （2）tools.js:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 /** * Created by smyhvae on 2018/02/03. */ //显示和隐藏 function show(ele) { ele.style.display = \"block\"; } function hide(ele) { ele.style.display = \"none\"; } function scroll() { // 开始封装自己的scrollTop if (window.pageYOffset != null) { // ie9+ 高版本浏览器 // 因为 window.pageYOffset 默认的是 0 所以这里需要判断 return { left: window.pageXOffset, top: window.pageYOffset } } else if (document.compatMode === \"CSS1Compat\") { // 标准浏览器 来判断有没有声明DTD return { left: document.documentElement.scrollLeft, top: document.documentElement.scrollTop } } return { // 未声明 DTD left: document.body.scrollLeft, top: document.body.scrollTop } } 效果演示：\n","wordCount":"4236","inLanguage":"en","datePublished":"2020-01-01T17:11:35+08:00","dateModified":"2020-01-01T17:11:35+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/tech/wait/04-javascript/39-%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%BB%91%E5%AE%9A%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1event/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=主页><span>主页</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=时间轴><span>时间轴</span></a></li><li><a href=https://bablvsj.github.io/tags title=标签><span>标签</span></a></li><li><a href=https://bablvsj.github.io/about title=关于><span>关于</span></a></li><li><a href=https://bablvsj.github.io/search title="🔍 (Alt + /)" accesskey=/><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>39-事件的绑定和事件对象Event</h1><div class=post-meta><ul class=post-tags-meta><a href=https://bablvsj.github.io/tags/javascript/>JavaScript</a></ul>9 min&nbsp;·&nbsp;<span title='2020-01-01 17:11:35 +0800 +0800'>2020/01/01</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#%e7%bb%91%e5%ae%9a%e4%ba%8b%e4%bb%b6%e7%9a%84%e4%b8%a4%e7%a7%8d%e6%96%b9%e5%bc%8fdom%e4%ba%8b%e4%bb%b6%e7%9a%84%e7%ba%a7%e5%88%ab aria-label=绑定事件的两种方式/DOM事件的级别>绑定事件的两种方式/DOM事件的级别</a><ul><li><a href=#dom0%e7%9a%84%e5%86%99%e6%b3%95onclick aria-label=DOM0的写法：onclick>DOM0的写法：onclick</a></li><li><a href=#dom2%e7%9a%84%e5%86%99%e6%b3%95addeventlistener%e9%ab%98%e7%89%88%e6%9c%ac%e6%b5%8f%e8%a7%88%e5%99%a8 aria-label=DOM2的写法：addEventListener（高版本浏览器）>DOM2的写法：addEventListener（高版本浏览器）</a></li><li><a href=#dom2%e7%9a%84%e5%86%99%e6%b3%95attacheventie8%e5%8f%8a%e4%bb%a5%e4%b8%8b%e7%89%88%e6%9c%ac%e6%b5%8f%e8%a7%88%e5%99%a8 aria-label=DOM2的写法：attachEvent（IE8及以下版本浏览器）>DOM2的写法：attachEvent（IE8及以下版本浏览器）</a></li><li><a href=#%e5%85%bc%e5%ae%b9%e6%80%a7%e5%86%99%e6%b3%95 aria-label=兼容性写法>兼容性写法</a></li></ul></li><li><a href=#%e4%ba%8b%e4%bb%b6%e5%af%b9%e8%b1%a1 aria-label=事件对象>事件对象</a><ul><li><a href=#%e8%8e%b7%e5%8f%96-event-%e5%af%b9%e8%b1%a1%e5%85%bc%e5%ae%b9%e6%80%a7%e9%97%ae%e9%a2%98 aria-label="获取 event 对象（兼容性问题）">获取 event 对象（兼容性问题）</a></li><li><a href=#event-%e5%b1%9e%e6%80%a7 aria-label="event 属性">event 属性</a></li></ul></li><li><a href=#event%e4%b8%be%e4%be%8b aria-label=Event举例>Event举例</a><ul><li><a href=#%e4%b8%be%e4%be%8b1%e4%bd%bf-div-%e8%b7%9f%e9%9a%8f%e9%bc%a0%e6%a0%87%e7%a7%bb%e5%8a%a8 aria-label="举例1：使 div 跟随鼠标移动">举例1：使 div 跟随鼠标移动</a></li><li><a href=#%e4%b8%be%e4%be%8b2%e8%8e%b7%e5%8f%96%e9%bc%a0%e6%a0%87%e8%b7%9d%e7%a6%bb%e6%89%80%e5%9c%a8%e7%9b%92%e5%ad%90%e7%9a%84%e8%b7%9d%e7%a6%bb aria-label=举例2：获取鼠标距离所在盒子的距离>举例2：获取鼠标距离所在盒子的距离</a></li><li><a href=#%e4%b8%be%e4%be%8b3%e5%95%86%e5%93%81%e6%94%be%e5%a4%a7%e9%95%9c aria-label=举例3：商品放大镜>举例3：商品放大镜</a></li></ul></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=绑定事件的两种方式dom事件的级别>绑定事件的两种方式/DOM事件的级别<a hidden class=anchor aria-hidden=true href=#绑定事件的两种方式dom事件的级别>#</a></h2><p>我们在之前的一篇文章《04-JavaScript/22-DOM简介和DOM操作》中已经讲过事件的概念。这里讲一下绑定（注册）事件的两种方式，我们以onclick事件为例。</p><h3 id=dom0的写法onclick>DOM0的写法：onclick<a hidden class=anchor aria-hidden=true href=#dom0的写法onclick>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>    <span class=nx>element</span><span class=p>.</span><span class=nx>onclick</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>举例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span>点我<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>btn</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;button&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//这种事件绑定的方式，如果绑定多个，则后面的会覆盖掉前面的
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>btn</span><span class=p>.</span><span class=nx>onclick</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;事件1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>btn</span><span class=p>.</span><span class=nx>onclick</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;事件2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>点击按钮后，上方代码的打印结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>事件2
</span></span></code></pre></td></tr></table></div></div><p>我们可以看到，<code>DOM对象.事件 = 函数</code>的这种绑定事件的方式：一个元素的一个事件只能绑定一个响应函数。如果绑定了多个响应函数，则后者会覆盖前者。</p><h3 id=dom2的写法addeventlistener高版本浏览器>DOM2的写法：addEventListener（高版本浏览器）<a hidden class=anchor aria-hidden=true href=#dom2的写法addeventlistener高版本浏览器>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>    <span class=nx>element</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=kc>false</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>参数解释：</p><ul><li><p>参数1：事件名的字符串(注意，没有on)</p></li><li><p>参数2：回调函数：当事件触发时，该函数会被执行</p></li><li><p>参数3：<strong>true表示捕获阶段触发，false表示冒泡阶段触发（默认）</strong>。如果不写，则默认为false。【重要】</p></li></ul><p>举例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span>按钮<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>btn</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;button&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// addEventListener: 事件监听器。 原事件被执行的时候，后面绑定的事件照样被执行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 这种写法不存在响应函数被覆盖的情况。（更适合团队开发）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>btn</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=nx>fn1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>btn</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=nx>fn2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>fn1</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;事件1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>fn2</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;事件2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>点击按钮后，上方代码的打印结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    事件1
</span></span><span class=line><span class=cl>    事件2
</span></span></code></pre></td></tr></table></div></div><p>我们可以看到，<code>addEventListener()</code>这种绑定事件的方式：</p><ul><li><p>一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。<strong>执行顺序是</strong>：事件被触发时，响应函数会按照函数的绑定顺序执行。</p></li><li><p>addEventListener()中的this，是绑定事件的对象。</p></li><li><p><code>addEventListener()</code>不支持 IE8 及以下的浏览器。在IE8中可以使用<code>attachEvent</code>来绑定事件（详见下一小段）。</p></li></ul><h3 id=dom2的写法attacheventie8及以下版本浏览器>DOM2的写法：attachEvent（IE8及以下版本浏览器）<a hidden class=anchor aria-hidden=true href=#dom2的写法attacheventie8及以下版本浏览器>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>    <span class=nx>element</span><span class=p>.</span><span class=nx>attachEvent</span><span class=p>(</span><span class=s1>&#39;onclick&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>参数解释：</p><ul><li><p>参数1：事件名的字符串(注意，有on)</p></li><li><p>参数2：回调函数：当事件触发时，该函数会被执行</p></li></ul><p>举例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span>按钮<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>btn</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s1>&#39;button&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>btn</span><span class=p>.</span><span class=nx>attachEvent</span><span class=p>(</span><span class=s1>&#39;onclick&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;事件1&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>btn</span><span class=p>.</span><span class=nx>attachEvent</span><span class=p>(</span><span class=s1>&#39;onclick&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;事件2&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>在低版本的IE浏览器上，点击按钮后，上方代码的打印结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    事件2
</span></span><span class=line><span class=cl>    事件1
</span></span></code></pre></td></tr></table></div></div><p>我们可以看到，<code>attachEvent()</code>这种绑定事件的方式：</p><ul><li><p>一个元素的一个事件，可以绑定多个响应函数。不存在响应函数被覆盖的情况。<strong>注意</strong>：执行顺序是，后绑定的先执行。</p></li><li><p>attachEvent()中的this，是window</p></li></ul><h3 id=兼容性写法>兼容性写法<a hidden class=anchor aria-hidden=true href=#兼容性写法>#</a></h3><p>上面的内容里，需要强调的是：</p><ul><li><p><code>addEventListener()</code>中的this，是绑定事件的对象。</p></li><li><p><code>attachEvent()</code>中的this，是window。</p></li></ul><p>既然这两个写法的<code>this</code>不同，那么，有没有一种兼容性的写法可以确保这两种绑定方式的this是相同的呢？我们可以封装一下。代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span>按钮<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>btn</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s1>&#39;button&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>myBind</span><span class=p>(</span><span class=nx>btn</span> <span class=p>,</span> <span class=s2>&#34;click&#34;</span> <span class=p>,</span> <span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>                <span class=nx>alert</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>//定义一个函数，用来为指定元素绑定响应函数
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>             * addEventListener()中的this，是绑定事件的对象
</span></span></span><span class=line><span class=cl><span class=cm>             * attachEvent()中的this，是window
</span></span></span><span class=line><span class=cl><span class=cm>             *  需要统一两个方法this
</span></span></span><span class=line><span class=cl><span class=cm>             */</span>
</span></span><span class=line><span class=cl>            <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>             * 参数：
</span></span></span><span class=line><span class=cl><span class=cm>             *  element 要绑定事件的对象
</span></span></span><span class=line><span class=cl><span class=cm>             *  eventStr 事件的字符串(不要on)
</span></span></span><span class=line><span class=cl><span class=cm>             *  callback 回调函数
</span></span></span><span class=line><span class=cl><span class=cm>             */</span>
</span></span><span class=line><span class=cl>            <span class=kd>function</span> <span class=nx>myBind</span><span class=p>(</span><span class=nx>element</span> <span class=p>,</span> <span class=nx>eventStr</span> <span class=p>,</span> <span class=nx>callback</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=nx>element</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                    <span class=c1>//大部分浏览器兼容的方式
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=nx>element</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=nx>eventStr</span> <span class=p>,</span> <span class=nx>callback</span> <span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>                     * this是谁，由调用方式决定
</span></span></span><span class=line><span class=cl><span class=cm>                     * callback.call(element)
</span></span></span><span class=line><span class=cl><span class=cm>                     */</span>
</span></span><span class=line><span class=cl>                    <span class=c1>//IE8及以下
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=nx>element</span><span class=p>.</span><span class=nx>attachEvent</span><span class=p>(</span><span class=s2>&#34;on&#34;</span><span class=o>+</span><span class=nx>eventStr</span> <span class=p>,</span> <span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>                        <span class=c1>//在匿名函数 function 中调用回调函数callback
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=nx>callback</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=nx>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>});</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=事件对象>事件对象<a hidden class=anchor aria-hidden=true href=#事件对象>#</a></h2><p>当事件的响应函数被触发时，会产生一个事件对象<code>event</code>。浏览器每次都会将这个事件<code>event</code>作为实参传进之前的响应函数。</p><p>这个对象中包含了与当前事件相关的一切信息。比如鼠标的坐标、键盘的哪个按键被按下、鼠标滚轮滚动的方向等。</p><h3 id=获取-event-对象兼容性问题>获取 event 对象（兼容性问题）<a hidden class=anchor aria-hidden=true href=#获取-event-对象兼容性问题>#</a></h3><p>所有浏览器都支持event对象，但支持的方式不同。如下。</p><p>（1）普通浏览器的写法是 <code>event</code>。比如：</p><p><img loading=lazy src=http://img.smyhvae.com/20180203_1735.png alt></p><p>（2）ie 678 的写法是 <code>window.event</code>。此时，事件对象 event 是作为window对象的属性保存的。</p><p>于是，我们可以采取一种兼容性的写法。如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>    <span class=nx>event</span> <span class=o>=</span> <span class=nx>event</span> <span class=o>||</span> <span class=nb>window</span><span class=p>.</span><span class=nx>event</span><span class=p>;</span> <span class=c1>// 兼容性写法
</span></span></span></code></pre></td></tr></table></div></div><p>代码举例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c1>//点击页面的任何部分
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nb>document</span><span class=p>.</span><span class=nx>onclick</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>event</span> <span class=o>=</span> <span class=nx>event</span> <span class=o>||</span> <span class=nb>window</span><span class=p>.</span><span class=nx>event</span><span class=p>;</span> <span class=c1>////兼容性写法
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>timeStamp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>bubbles</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>button</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>pageX</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>pageY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>screenX</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>screenY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>type</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>clientX</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>clientY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=event-属性>event 属性<a hidden class=anchor aria-hidden=true href=#event-属性>#</a></h3><p>event 有很多属性，比如：</p><p><img loading=lazy src=http://img.smyhvae.com/20180203_1739.png alt></p><p>由于pageX 和 pageY的兼容性不好，我们可以这样做：</p><ul><li>鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。</li></ul><h2 id=event举例>Event举例<a hidden class=anchor aria-hidden=true href=#event举例>#</a></h2><h3 id=举例1使-div-跟随鼠标移动>举例1：使 div 跟随鼠标移动<a hidden class=anchor aria-hidden=true href=#举例1使-div-跟随鼠标移动>#</a></h3><p>代码实现：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>style</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>#</span><span class=nn>box1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>background-color</span><span class=p>:</span> <span class=kc>red</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c>/*
</span></span></span><span class=line><span class=cl><span class=c>        * 开启box1的绝对定位
</span></span></span><span class=line><span class=cl><span class=c>        */</span>
</span></span><span class=line><span class=cl>        <span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nb>window</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>         * 使div可以跟随鼠标移动
</span></span></span><span class=line><span class=cl><span class=cm>         */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//获取box1
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=nx>box1</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;box1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//给整个页面绑定：鼠标移动事件
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>document</span><span class=p>.</span><span class=nx>onmousemove</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>//兼容的方式获取event对象
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>event</span> <span class=o>=</span> <span class=nx>event</span> <span class=o>||</span> <span class=nb>window</span><span class=p>.</span><span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=c1>// 鼠标在页面的位置 = 滚动条滚动的距离 + 可视区域的坐标。
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=kd>var</span> <span class=nx>pagex</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>pageX</span> <span class=o>||</span> <span class=nx>scroll</span><span class=p>().</span><span class=nx>left</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>clientX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=kd>var</span> <span class=nx>pagey</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>pageY</span> <span class=o>||</span> <span class=nx>scroll</span><span class=p>().</span><span class=nx>top</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>clientY</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=c1>//   设置div的偏移量（相对于整个页面）
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=c1>// 注意，如果想通过 style.left 来设置属性，一定要给 box1开启绝对定位。
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>box1</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>left</span> <span class=o>=</span> <span class=nx>pagex</span> <span class=o>+</span> <span class=s2>&#34;px&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=nx>box1</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>top</span> <span class=o>=</span> <span class=nx>pagey</span> <span class=o>+</span> <span class=s2>&#34;px&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>// scroll 函数封装
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kd>function</span> <span class=nx>scroll</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>//此函数的返回值是对象
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>left</span><span class=o>:</span> <span class=nb>window</span><span class=p>.</span><span class=nx>pageYOffset</span> <span class=o>||</span> <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>scrollTop</span> <span class=o>||</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>scrollTop</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>right</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>window</span><span class=p>.</span><span class=nx>pageXOffset</span> <span class=o>||</span> <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>scrollLeft</span> <span class=o>||</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>scrollLeft</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>body</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;height: 1000px;width: 2000px;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;box1&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=举例2获取鼠标距离所在盒子的距离>举例2：获取鼠标距离所在盒子的距离<a hidden class=anchor aria-hidden=true href=#举例2获取鼠标距离所在盒子的距离>#</a></h3><p>关键点：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    鼠标距离所在盒子的距离 = 鼠标在整个页面的位置 - 所在盒子在整个页面的位置
</span></span></code></pre></td></tr></table></div></div><p>代码演示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>box</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>width</span><span class=p>:</span> <span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>height</span><span class=p>:</span> <span class=mi>200</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding-top</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background-color</span><span class=p>:</span> <span class=kc>pink</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>text-align</span><span class=p>:</span> <span class=kc>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>font</span><span class=p>:</span> <span class=mi>18</span><span class=kt>px</span><span class=o>/</span><span class=mi>30</span><span class=kt>px</span> <span class=s2>&#34;simsun&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>cursor</span><span class=p>:</span> <span class=kc>pointer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;box&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;animate.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c1>//需求：鼠标进入盒子之后只要移动，哪怕1像素，随时显示鼠标在盒子中的坐标。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//技术点：新事件，onmousemove：在事件源上，哪怕鼠标移动1像素也会触动这个事件。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//一定程度上，模拟了定时器
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//步骤：
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//1.老三步和新五步
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//2.获取鼠标在整个页面的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//3.获取盒子在整个页面的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//4.用鼠标的位置减去盒子的位置赋值给盒子的内容。
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>//1.老三步和新五步
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>div</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;div&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>div</span><span class=p>.</span><span class=nx>onmousemove</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>event</span> <span class=o>=</span> <span class=nx>event</span> <span class=o>||</span> <span class=nb>window</span><span class=p>.</span><span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>//2.获取鼠标在整个页面的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=nx>pagex</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>pageX</span> <span class=o>||</span> <span class=nx>scroll</span><span class=p>().</span><span class=nx>left</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>clientX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>pagey</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>pageY</span> <span class=o>||</span> <span class=nx>scroll</span><span class=p>().</span><span class=nx>top</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>clientY</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>//3.获取盒子在整个页面的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// var xx =
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// var yy =
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//4.用鼠标的位置减去盒子的位置赋值给盒子的内容。
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=nx>targetx</span> <span class=o>=</span> <span class=nx>pagex</span> <span class=o>-</span> <span class=nx>div</span><span class=p>.</span><span class=nx>offsetLeft</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>targety</span> <span class=o>=</span> <span class=nx>pagey</span> <span class=o>-</span> <span class=nx>div</span><span class=p>.</span><span class=nx>offsetTop</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s2>&#34;鼠标在盒子中的X坐标为：&#34;</span> <span class=o>+</span> <span class=nx>targetx</span> <span class=o>+</span> <span class=s2>&#34;px;&lt;br&gt;鼠标在盒子中的Y坐标为：&#34;</span> <span class=o>+</span> <span class=nx>targety</span> <span class=o>+</span> <span class=s2>&#34;px;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>实现效果：</p><p><img loading=lazy src=http://img.smyhvae.com/20180203_1828.gif alt></p><h3 id=举例3商品放大镜>举例3：商品放大镜<a hidden class=anchor aria-hidden=true href=#举例3商品放大镜>#</a></h3><p>代码实现：</p><p>（1）index.html:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>box</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>width</span><span class=p>:</span> <span class=mi>350</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>height</span><span class=p>:</span> <span class=mi>350</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=mh>#ccc</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>position</span><span class=p>:</span> <span class=kc>relative</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>big</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>width</span><span class=p>:</span> <span class=mi>400</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>height</span><span class=p>:</span> <span class=mi>400</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>left</span><span class=p>:</span> <span class=mi>360</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=mh>#ccc</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>overflow</span><span class=p>:</span> <span class=kc>hidden</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>display</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>/*mask的中文是：遮罩*/</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>mask</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>width</span><span class=p>:</span> <span class=mi>175</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>height</span><span class=p>:</span> <span class=mi>175</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>left</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>cursor</span><span class=p>:</span> <span class=kc>move</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>display</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>small</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>position</span><span class=p>:</span> <span class=kc>relative</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>img</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>vertical-align</span><span class=p>:</span> <span class=kc>top</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;tools.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nb>window</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>//需求：鼠标放到小盒子上，让大盒子里面的图片和我们同步等比例移动。
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//技术点：onmouseenter==onmouseover 第一个不冒泡
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//技术点：onmouseleave==onmouseout  第一个不冒泡
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//步骤：
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//1.鼠标放上去显示盒子，移开隐藏盒子。
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//2.老三步和新五步（黄盒子跟随移动）
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//3.右侧的大图片，等比例移动。
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=c1>//0.获取相关元素
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kd>var</span> <span class=nx>box</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByClassName</span><span class=p>(</span><span class=s2>&#34;box&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>small</span> <span class=o>=</span> <span class=nx>box</span><span class=p>.</span><span class=nx>firstElementChild</span> <span class=o>||</span> <span class=nx>box</span><span class=p>.</span><span class=nx>firstChild</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>big</span> <span class=o>=</span> <span class=nx>box</span><span class=p>.</span><span class=nx>children</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>mask</span> <span class=o>=</span> <span class=nx>small</span><span class=p>.</span><span class=nx>children</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>bigImg</span> <span class=o>=</span> <span class=nx>big</span><span class=p>.</span><span class=nx>children</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>//1.鼠标放上去显示盒子，移开隐藏盒子。(为小盒子绑定事件)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>small</span><span class=p>.</span><span class=nx>onmouseenter</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>//封装好方法调用：显示元素
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>show</span><span class=p>(</span><span class=nx>mask</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>show</span><span class=p>(</span><span class=nx>big</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>small</span><span class=p>.</span><span class=nx>onmouseleave</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>//封装好方法调用：隐藏元素
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>hide</span><span class=p>(</span><span class=nx>mask</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>hide</span><span class=p>(</span><span class=nx>big</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>//2.老三步和新五步（黄盒子跟随移动）
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//绑定的事件是onmousemove，而事件源是small(只要在小盒子上移动1像素，黄盒子也要跟随)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>small</span><span class=p>.</span><span class=nx>onmousemove</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>//新五步
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>event</span> <span class=o>=</span> <span class=nx>event</span> <span class=o>||</span> <span class=nb>window</span><span class=p>.</span><span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>//想要移动黄盒子，必须要知道鼠标在small小图中的位置。
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kd>var</span> <span class=nx>pagex</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>pageX</span> <span class=o>||</span> <span class=nx>scroll</span><span class=p>().</span><span class=nx>left</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>clientX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>pagey</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>pageY</span> <span class=o>||</span> <span class=nx>scroll</span><span class=p>().</span><span class=nx>top</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>clientY</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>//x：mask的left值，y：mask的top值。
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=nx>pagex</span> <span class=o>-</span> <span class=nx>box</span><span class=p>.</span><span class=nx>offsetLeft</span> <span class=o>-</span> <span class=nx>mask</span><span class=p>.</span><span class=nx>offsetWidth</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=c1>//除以2，可以保证鼠标mask的中间
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=nx>pagey</span> <span class=o>-</span> <span class=nx>box</span><span class=p>.</span><span class=nx>offsetTop</span> <span class=o>-</span> <span class=nx>mask</span><span class=p>.</span><span class=nx>offsetHeight</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>//限制换盒子的范围
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=c1>//left取值为大于0，小盒子的宽-mask的宽。
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=nx>x</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>x</span> <span class=o>&gt;</span> <span class=nx>small</span><span class=p>.</span><span class=nx>offsetWidth</span> <span class=o>-</span> <span class=nx>mask</span><span class=p>.</span><span class=nx>offsetWidth</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>x</span> <span class=o>=</span> <span class=nx>small</span><span class=p>.</span><span class=nx>offsetWidth</span> <span class=o>-</span> <span class=nx>mask</span><span class=p>.</span><span class=nx>offsetWidth</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=c1>//top同理。
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=nx>y</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>y</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>y</span> <span class=o>&gt;</span> <span class=nx>small</span><span class=p>.</span><span class=nx>offsetHeight</span> <span class=o>-</span> <span class=nx>mask</span><span class=p>.</span><span class=nx>offsetHeight</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>y</span> <span class=o>=</span> <span class=nx>small</span><span class=p>.</span><span class=nx>offsetHeight</span> <span class=o>-</span> <span class=nx>mask</span><span class=p>.</span><span class=nx>offsetHeight</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>//移动黄盒子
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>small</span><span class=p>.</span><span class=nx>offsetHeight</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>mask</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>left</span> <span class=o>=</span> <span class=nx>x</span> <span class=o>+</span> <span class=s2>&#34;px&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>mask</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>top</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>+</span> <span class=s2>&#34;px&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>//3.右侧的大图片，等比例移动。
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=c1>//如何移动大图片？等比例移动。
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=c1>//    大图片/大盒子 = 小图片/mask盒子
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=c1>//    大图片走的距离/mask走的距离 = （大图片-大盒子）/（小图片-黄盒子）
</span></span></span><span class=line><span class=cl><span class=c1>//                var bili = (bigImg.offsetWidth-big.offsetWidth)/(small.offsetWidth-mask.offsetWidth);
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>                <span class=c1>//大图片走的距离/mask盒子都的距离 = 大图片/小图片
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kd>var</span> <span class=nx>bili</span> <span class=o>=</span> <span class=nx>bigImg</span><span class=p>.</span><span class=nx>offsetWidth</span> <span class=o>/</span> <span class=nx>small</span><span class=p>.</span><span class=nx>offsetWidth</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>xx</span> <span class=o>=</span> <span class=nx>bili</span> <span class=o>*</span> <span class=nx>x</span><span class=p>;</span>  <span class=c1>//知道比例，就可以移动大图片了
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kd>var</span> <span class=nx>yy</span> <span class=o>=</span> <span class=nx>bili</span> <span class=o>*</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=nx>bigImg</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>marginTop</span> <span class=o>=</span> <span class=o>-</span><span class=nx>yy</span> <span class=o>+</span> <span class=s2>&#34;px&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>bigImg</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>marginLeft</span> <span class=o>=</span> <span class=o>-</span><span class=nx>xx</span> <span class=o>+</span> <span class=s2>&#34;px&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;box&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;small&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;images/001.jpg&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;mask&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;big&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;images/0001.jpg&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>（2）tools.js:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Created by smyhvae on 2018/02/03.
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//显示和隐藏
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>show</span><span class=p>(</span><span class=nx>ele</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>ele</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s2>&#34;block&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>hide</span><span class=p>(</span><span class=nx>ele</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>ele</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s2>&#34;none&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>scroll</span><span class=p>()</span> <span class=p>{</span>  <span class=c1>// 开始封装自己的scrollTop
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>pageYOffset</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>  <span class=c1>// ie9+ 高版本浏览器
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 因为 window.pageYOffset 默认的是  0  所以这里需要判断
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>left</span><span class=o>:</span> <span class=nb>window</span><span class=p>.</span><span class=nx>pageXOffset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>top</span><span class=o>:</span> <span class=nb>window</span><span class=p>.</span><span class=nx>pageYOffset</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>compatMode</span> <span class=o>===</span> <span class=s2>&#34;CSS1Compat&#34;</span><span class=p>)</span> <span class=p>{</span>    <span class=c1>// 标准浏览器   来判断有没有声明DTD
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>left</span><span class=o>:</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>scrollLeft</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>top</span><span class=o>:</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>scrollTop</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>   <span class=c1>// 未声明 DTD
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>left</span><span class=o>:</span> <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>scrollLeft</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>top</span><span class=o>:</span> <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>scrollTop</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>效果演示：</p><p><img loading=lazy src=http://img.smyhvae.com/20180203_1920.gif alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/javascript/>JavaScript</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/tech/wait/04-javascript/38-client%E5%8F%AF%E8%A7%86%E5%8C%BA%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7/><span class=title>« Prev</span><br><span>38-client(可视区)相关属性</span></a>
<a class=next href=https://bablvsj.github.io/posts/tech/wait/04-javascript/40-%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BC%A0%E6%92%AD%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1/><span class=title>Next »</span><br><span>40-事件的传播和事件冒泡</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>本站由</span><img width=60 src=/images/upyun.png>提供CDN加速/云存储服务</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>